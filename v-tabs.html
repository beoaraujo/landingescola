<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Escola de Contas | TCM-PA — Versão Tabs</title>
    <link href="https://fonts.googleapis.com/css2?family=DM+Sans:ital,opsz,wght@0,9..40,400;0,9..40,500;0,9..40,600;0,9..40,700;0,9..40,800;1,9..40,400&family=Playfair+Display:wght@700;800&display=swap" rel="stylesheet">
    <style>
        /* ═══════════════════════════════════════════
           MOBILE-FIRST RESET & TOKENS
           Base = mobile (< 640px). Scale up via min-width.
        ═══════════════════════════════════════════ */
        *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
        :root {
            --font-body: 'DM Sans', system-ui, sans-serif;
            --font-display: 'Playfair Display', Georgia, serif;
            --navy-900: #002a4a;
            --navy-800: #004a80;
            --sky-500: #0693e3;
            --sky-400: #38a6e8;
            --emerald-500: #00d084;
            --emerald-400: #34dda0;
            --emerald-600: #00a86b;
            --amber-500: #8B1A2B;
            --amber-400: #A52240;
            --red-500: #CC3366;
            --slate-50: #f8fafc;
            --slate-100: #f1f5f9;
            --slate-200: #e2e8f0;
            --slate-300: #cbd5e1;
            --slate-400: #94a3b8;
            --slate-500: #64748b;
            --slate-600: #475569;
            --slate-700: #334155;
            --slate-800: #1e293b;
            --slate-900: #0f172a;
            --radius-lg: 16px;
            --radius-xl: 20px;
            --shadow-card: 0 1px 3px rgba(0,0,0,.06), 0 6px 16px rgba(0,0,0,.05);
            --shadow-card-hover: 0 4px 12px rgba(0,0,0,.08), 0 16px 40px rgba(0,0,0,.1);
            --shadow-float: 0 8px 32px rgba(0,0,0,.12), 0 2px 8px rgba(0,0,0,.06);
            --transition-base: 0.25s cubic-bezier(.4,0,.2,1);
            /* Safe area for notched phones */
            --safe-bottom: env(safe-area-inset-bottom, 0px);
            --safe-left: env(safe-area-inset-left, 0px);
            --safe-right: env(safe-area-inset-right, 0px);
        }
        html { scroll-behavior: smooth; -webkit-font-smoothing: antialiased; -webkit-text-size-adjust: 100%; }
        body {
            font-family: var(--font-body); background: var(--slate-100); color: var(--slate-800);
            min-height: 100vh; min-height: 100dvh; /* dynamic viewport for mobile */
            line-height: 1.6; overflow-x: hidden;
        }
        img { max-width: 100%; display: block; }
        button { cursor: pointer; font-family: inherit; border: none; -webkit-tap-highlight-color: transparent; }
        input, select { font-family: inherit; font-size: 16px; /* prevents iOS zoom on focus */ }

        /* ═══════════════════════════════════════════
           HEADER — Mobile base (compact)
        ═══════════════════════════════════════════ */
        .site-header {
            position: fixed; top: 0; left: 0; right: 0; z-index: 100;
            background: rgba(255,255,255,.92);
            backdrop-filter: blur(16px) saturate(180%);
            -webkit-backdrop-filter: blur(16px) saturate(180%);
            border-bottom: 1px solid var(--slate-200);
            height: 56px;
            padding-left: var(--safe-left); padding-right: var(--safe-right);
            transition: transform .3s ease;
        }
        /* Hide header when user is choosing courses */
        body.header-hidden .site-header { transform: translateY(-100%); }
        body.header-hidden .progress-bar { top: 0; }
        .header-inner {
            margin: 0 auto; padding: 0 16px;
            display: flex; align-items: center; justify-content: space-between; height: 100%;
        }
        .logo-group { display: flex; align-items: center; }
        .logo-img { height: 36px; width: auto; object-fit: contain; }
        .header-badge {
            font-size: 11px; color: var(--slate-500); background: var(--slate-100);
            padding: 3px 10px; border-radius: 99px; font-weight: 500; flex-shrink: 0;
        }

        @media (min-width: 640px) {
            .site-header { height: 60px; }
            .header-inner { padding: 0 24px; max-width: 1200px; }
            .logo-img { height: 42px; }
            .header-badge { font-size: 12px; padding: 4px 12px; }
        }

        /* ═══════════════════════════════════════════
           HERO — Mobile base (tighter)
        ═══════════════════════════════════════════ */
        .hero {
            padding-top: 56px; /* match mobile header */
            background: linear-gradient(160deg, var(--navy-900) 0%, var(--navy-800) 40%, #10517f 100%);
            position: relative; overflow: hidden;
        }
        /* Video background */
        .hero-video {
            position: absolute; inset: 0; width: 100%; height: 100%;
            object-fit: cover; z-index: 0; opacity: 0;
            transition: opacity 1s ease;
        }
        .hero-video.loaded { opacity: .25; }
        /* Dark overlay on top of video */
        .hero-overlay {
            position: absolute; inset: 0; z-index: 0;
            background: linear-gradient(160deg, rgba(0,42,74,.85) 0%, rgba(0,74,128,.75) 40%, rgba(16,81,127,.7) 100%);
            pointer-events: none;
        }
        .hero::before {
            content: ''; position: absolute; inset: 0; z-index: 1;
            background-image: radial-gradient(rgba(255,255,255,.04) 1px, transparent 1px);
            background-size: 24px 24px;
            pointer-events: none;
        }
        .hero::after {
            content: ''; position: absolute; bottom: 0; left: 0; right: 0; height: 60px; z-index: 1;
            background: linear-gradient(to top, var(--slate-100), transparent);
            pointer-events: none;
        }
        .hero-inner {
            max-width: 800px; margin: 0 auto; padding: 36px 16px 48px; text-align: center;
            position: relative; z-index: 2;
        }
        .hero-badge {
            display: inline-flex; align-items: center; gap: 6px;
            background: rgba(255,255,255,.08); border: 1px solid rgba(255,255,255,.1);
            padding: 5px 12px; border-radius: 99px; margin-bottom: 14px;
        }
        .hero-badge .dot { width: 7px; height: 7px; background: var(--emerald-400); border-radius: 50%; animation: pulse-dot 2s ease infinite; }
        @keyframes pulse-dot { 0%,100% { opacity: 1; } 50% { opacity: .4; } }
        .hero-badge span { color: var(--emerald-400); font-size: 12px; font-weight: 600; }
        .hero h1 {
            font-family: var(--font-display); font-size: 24px; color: #fff;
            line-height: 1.2; margin-bottom: 10px;
        }
        .hero h1 em { font-style: normal; color: var(--amber-400); }
        .hero p { color: rgba(255,255,255,.6); font-size: 14px; max-width: 540px; margin: 0 auto 18px; line-height: 1.5; }
        .hero-tags { display: flex; flex-wrap: wrap; justify-content: center; gap: 6px; }
        .hero-tag {
            background: rgba(255,255,255,.07); border: 1px solid rgba(255,255,255,.08);
            padding: 5px 10px; border-radius: 99px; color: rgba(255,255,255,.7);
            font-size: 12px; font-weight: 500;
        }
        .hero-tag.highlight { background: rgba(165,34,64,.2); border-color: rgba(165,34,64,.35); color: var(--amber-400); }

        @media (min-width: 640px) {
            .hero { padding-top: 60px; }
            .hero-inner { padding: 56px 24px 64px; }
            .hero h1 { font-size: clamp(28px, 5vw, 44px); }
            .hero p { font-size: 16px; margin-bottom: 24px; }
            .hero-badge span { font-size: 13px; }
            .hero-tags { gap: 8px; }
            .hero-tag { padding: 6px 14px; font-size: 13px; }
        }

        /* ═══════════════════════════════════════════
           BENEFITS SECTION
        ═══════════════════════════════════════════ */
        .benefits {
            background: #fff;
            padding: 40px 16px;
            position: relative;
        }
        .benefits-inner {
            max-width: 900px; margin: 0 auto;
        }
        .benefits-title {
            font-family: var(--font-display); font-size: 20px; color: var(--slate-800);
            text-align: center; margin-bottom: 8px;
        }
        .benefits-sub {
            text-align: center; color: var(--slate-500); font-size: 13px;
            margin-bottom: 28px;
        }
        .benefits-grid {
            display: grid; grid-template-columns: 1fr; gap: 16px;
        }
        .benefit-card {
            display: flex; align-items: flex-start; gap: 14px;
            padding: 16px; border-radius: var(--radius-lg);
            background: var(--slate-50); border: 1px solid var(--slate-200);
            transition: all var(--transition-base);
        }
        .benefit-icon {
            width: 40px; height: 40px; border-radius: 12px;
            display: flex; align-items: center; justify-content: center;
            flex-shrink: 0; color: #fff;
        }
        .benefit-icon .icon { width: 20px; height: 20px; }
        .benefit-icon .icon svg { stroke: #fff; }
        .benefit-text h3 {
            font-size: 14px; font-weight: 700; color: var(--slate-800);
            margin-bottom: 4px; line-height: 1.3;
        }
        .benefit-text p {
            font-size: 12.5px; color: var(--slate-500); line-height: 1.5;
        }
        @media (min-width: 640px) {
            .benefits { padding: 56px 24px; }
            .benefits-title { font-size: 26px; margin-bottom: 10px; }
            .benefits-sub { font-size: 15px; margin-bottom: 36px; }
            .benefits-grid { grid-template-columns: repeat(2, 1fr); gap: 20px; }
            .benefit-card { padding: 20px; }
            .benefit-card:hover { transform: translateY(-2px); box-shadow: var(--shadow-card); }
            .benefit-icon { width: 44px; height: 44px; }
            .benefit-text h3 { font-size: 15px; }
            .benefit-text p { font-size: 13px; }
        }

        /* ═══════════════════════════════════════════
           PROGRESS BAR — Mobile base (compact circles, no labels)
        ═══════════════════════════════════════════ */
        .progress-bar {
            position: sticky; top: 56px; z-index: 50;
            background: rgba(255,255,255,.95);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border-bottom: 1px solid var(--slate-200);
            padding: 12px 0;
            transition: top .3s ease;
        }
        .progress-inner {
            max-width: 700px; margin: 0 auto; padding: 0 12px;
            display: flex; align-items: center;
        }
        .prog-step {
            display: flex; flex-direction: column; align-items: center; cursor: pointer;
            position: relative; flex-shrink: 0;
            -webkit-tap-highlight-color: transparent;
            /* Bigger touch target on mobile */
            padding: 4px;
        }
        .prog-circle {
            width: 32px; height: 32px; border-radius: 50%;
            display: flex; align-items: center; justify-content: center;
            font-weight: 700; font-size: 11px;
            border: 2.5px solid var(--slate-300); background: #fff; color: var(--slate-400);
            transition: all var(--transition-base);
            position: relative; z-index: 2;
        }
        .prog-label {
            font-size: 9px; color: var(--slate-400); margin-top: 3px; font-weight: 500;
            white-space: nowrap; display: none; /* hidden on mobile */
        }
        .prog-line {
            flex: 1; height: 2.5px; background: var(--slate-200); border-radius: 99px;
            transition: background var(--transition-base); min-width: 8px;
        }

        /* Progress States */
        .prog-step.active .prog-circle {
            background: linear-gradient(135deg, var(--sky-500), var(--navy-800));
            border-color: var(--sky-500); color: #fff;
            box-shadow: 0 0 0 3px rgba(6,147,227,.18);
        }
        .prog-step.active .prog-label { color: var(--sky-500); font-weight: 600; }
        .prog-step.completed .prog-circle {
            background: linear-gradient(135deg, var(--emerald-500), var(--emerald-600));
            border-color: var(--emerald-500); color: #fff;
        }
        .prog-step.completed .prog-label { color: var(--emerald-500); }
        .prog-step.skipped .prog-circle { background: var(--slate-100); border-color: var(--slate-300); color: var(--slate-400); }
        .prog-line.done { background: var(--emerald-500); }

        @media (min-width: 640px) {
            .progress-bar { top: 60px; padding: 14px 0; }
            body.header-hidden .progress-bar { top: 0; }
            .progress-inner { padding: 0 24px; }
            .prog-step { padding: 2px; }
            .prog-step:hover .prog-circle { transform: scale(1.12); }
            .prog-circle { width: 38px; height: 38px; font-size: 13px; }
            .prog-label { display: block; font-size: 10px; margin-top: 4px; }
            .prog-line { height: 3px; min-width: 12px; }
            .prog-step.active .prog-circle { box-shadow: 0 0 0 4px rgba(6,147,227,.18); }
        }

        /* ═══════════════════════════════════════════
           FLOATING COUNTER — Mobile base (smaller, bottom safe area)
        ═══════════════════════════════════════════ */
        .float-counter {
            position: fixed; z-index: 90;
            bottom: calc(16px + var(--safe-bottom)); right: 16px;
            background: #fff; border-radius: var(--radius-xl);
            box-shadow: var(--shadow-float); border: 1px solid var(--slate-200);
            padding: 10px 14px; text-align: center; min-width: 100px;
            transition: all var(--transition-base);
        }
        .float-counter-label { font-size: 10px; color: var(--slate-500); font-weight: 500; margin-bottom: 2px; }
        .float-counter-num { font-size: 24px; font-weight: 800; color: var(--slate-800); line-height: 1; }
        .float-counter-num small { font-size: 14px; font-weight: 500; color: var(--slate-400); }
        .float-counter-status {
            margin-top: 6px; font-size: 10px; font-weight: 600;
            padding: 2px 8px; border-radius: 99px; display: inline-block;
        }
        .float-counter-status.warn { background: #fce4ea; color: #8B1A2B; }
        .float-counter-status.ok { background: #d1fae5; color: #065f46; }

        @media (min-width: 640px) {
            .float-counter { bottom: 24px; right: 24px; padding: 16px 20px; min-width: 120px; }
            .float-counter-num { font-size: 32px; }
            .float-counter-num small { font-size: 16px; }
            .float-counter-label { font-size: 11px; }
            .float-counter-status { font-size: 11px; padding: 3px 10px; margin-top: 8px; }
        }

        /* ═══════════════════════════════════════════
           STEP PANELS — Mobile base
        ═══════════════════════════════════════════ */
        .main-content {
            margin: 0 auto; padding: 20px 16px 120px;
            padding-bottom: calc(120px + var(--safe-bottom));
        }
        .step-panel { display: none; animation: fadeSlide .35s ease; }
        .step-panel.active { display: block; }
        @keyframes fadeSlide { from { opacity: 0; transform: translateY(12px); } to { opacity: 1; transform: translateY(0); } }

        .turno-header { text-align: center; margin-bottom: 20px; }
        .turno-info { text-align: center; margin-bottom: 10px; }
        .turno-badge {
            display: inline-block; padding: 4px 12px; border-radius: 99px;
            font-size: 11px; font-weight: 600; margin-bottom: 6px;
        }
        .turno-title { font-family: var(--font-display); font-size: 22px; color: var(--slate-800); margin-bottom: 4px; }
        .turno-sub { color: var(--slate-500); font-size: 13px; }

        @media (min-width: 640px) {
            .main-content { max-width: 1100px; padding: 32px 24px 140px; }
            .turno-header { margin-bottom: 32px; }
            .turno-badge { padding: 5px 16px; font-size: 13px; margin-bottom: 8px; }
            .turno-title { font-size: 28px; }
            .turno-sub { font-size: 14px; }
        }

        /* ═══════════════════════════════════════════
           COURSE TABS — Selector-style with color bars
        ═══════════════════════════════════════════ */
        .tabs-label {
            font-size: 11px; font-weight: 600; color: var(--slate-500);
            text-transform: uppercase; letter-spacing: .06em;
            margin-bottom: 8px; text-align: center;
        }
        .course-tabs {
            display: flex; flex-direction: row; gap: 6px;
            margin-bottom: 0; position: relative;
        }
        .course-tab {
            flex: 1; display: flex; flex-direction: column; align-items: center; gap: 6px;
            padding: 10px 6px 10px; border-radius: 12px;
            border: 2px solid var(--slate-200); background: #fff;
            font-family: var(--font-body); cursor: pointer;
            transition: all var(--transition-base);
            text-align: center; position: relative;
            -webkit-tap-highlight-color: transparent;
            overflow: hidden;
        }
        .course-tab:active { transform: scale(.97); }
        /* Color bar on top */
        .tab-color {
            position: absolute; top: 0; left: 0; right: 0;
            height: 4px; border-radius: 0; flex-shrink: 0;
        }
        /* Radio circle */
        .tab-radio {
            width: 18px; height: 18px; border-radius: 50%;
            border: 2px solid var(--slate-300); flex-shrink: 0;
            display: flex; align-items: center; justify-content: center;
            transition: all var(--transition-base);
            margin-top: 4px;
        }
        .tab-radio::after {
            content: ''; width: 0; height: 0; border-radius: 50%;
            background: var(--sky-500); transition: all .2s cubic-bezier(.34,1.56,.64,1);
        }
        .tab-content { flex: 1; min-width: 0; }
        .tab-title { font-size: 11px; font-weight: 700; color: var(--slate-800); line-height: 1.2; }
        .tab-subtitle { font-size: 9px; color: var(--slate-400); font-weight: 500; margin-top: 2px; line-height: 1.3; }

        /* Active tab — viewing this card */
        .course-tab.active {
            border-color: var(--sky-500); background: #f0f7ff;
            box-shadow: 0 0 0 3px rgba(6,147,227,.1);
        }
        .course-tab.active .tab-radio { border-color: var(--sky-500); }
        .course-tab.active .tab-radio::after { width: 8px; height: 8px; }
        .course-tab.active .tab-title { color: var(--sky-500); }

        /* Selected/chosen tab — green check */
        .course-tab.tab-selected {
            border-color: var(--emerald-500); background: #ecfdf5;
            box-shadow: 0 0 0 3px rgba(0,208,132,.1);
        }
        .course-tab.tab-selected .tab-radio {
            border-color: var(--emerald-500); background: var(--emerald-500);
        }
        .course-tab.tab-selected .tab-radio::after {
            width: 8px; height: 8px; background: #fff;
            /* checkmark via clip-path */
            clip-path: polygon(20% 50%, 40% 70%, 80% 30%, 85% 35%, 40% 80%, 15% 55%);
            border-radius: 0;
        }
        .course-tab.tab-selected .tab-title { color: var(--emerald-600); }
        .course-tab.tab-selected .tab-subtitle { color: var(--emerald-500); }

        /* Arrow connector from active tab to card */
        .tab-arrow {
            display: block; height: 12px; position: relative;
        }
        .tab-arrow::after {
            content: ''; width: 12px; height: 12px; background: #fff;
            border: 2px solid var(--slate-200); border-top: none; border-right: none;
            position: absolute; top: -6px;
            box-shadow: -2px 2px 4px rgba(0,0,0,.03);
            left: var(--arrow-left, 16.66%);
            transform: translateX(-50%) rotate(-45deg);
            transition: left .25s ease;
        }

        /* ═══════════════════════════════════════════
           COURSE CARDS — Tab content panel
        ═══════════════════════════════════════════ */
        .cards-grid { display: block; }
        .course-card {
            background: #fff; border-radius: var(--radius-lg); overflow: hidden;
            border: 2px solid var(--slate-200); box-shadow: var(--shadow-card);
            transition: all var(--transition-base); cursor: pointer; position: relative;
            -webkit-tap-highlight-color: transparent;
            display: none;
        }
        .course-card.tab-visible { display: block; animation: fadeSlide .25s ease; }
        .course-card:active { transform: scale(.98); }
        .course-card.selected {
            border-color: var(--emerald-500);
            box-shadow: 0 0 0 3px rgba(0,208,132,.15), var(--shadow-card);
        }
        .course-card.selected .card-check { opacity: 1; transform: scale(1); }
        .course-card.selected .card-head::after {
            content: ''; position: absolute; inset: 0; background: rgba(0,208,132,.15);
        }

        .card-head { padding: 16px; position: relative; overflow: hidden; }
        .card-head::before {
            content: ''; position: absolute; top: -50%; right: -30%; width: 200px; height: 200px;
            background: radial-gradient(circle, rgba(255,255,255,.1) 0%, transparent 70%);
        }
        .card-check {
            position: absolute; top: 10px; right: 10px; width: 28px; height: 28px;
            background: var(--emerald-500); border-radius: 50%;
            display: flex; align-items: center; justify-content: center;
            opacity: 0; transform: scale(.5); transition: all .25s cubic-bezier(.34,1.56,.64,1);
            box-shadow: 0 2px 8px rgba(0,208,132,.4); z-index: 2;
        }
        .card-check svg { width: 16px; height: 16px; color: #fff; stroke-width: 3; }
        .card-tag {
            display: inline-block; padding: 2px 8px; border-radius: 99px;
            font-size: 10px; font-weight: 600; background: rgba(255,255,255,.18); color: #fff;
            margin-bottom: 6px;
        }
        .card-head h3 { color: #fff; font-weight: 700; font-size: 16px; line-height: 1.25; }
        .card-head p { color: rgba(255,255,255,.75); font-size: 12px; margin-top: 2px; }

        .card-body { padding: 16px; }
        .instructor {
            display: flex; align-items: center; gap: 10px;
            padding-bottom: 12px; margin-bottom: 12px; border-bottom: 1px solid var(--slate-100);
        }
        .instructor-avatar {
            width: 36px; height: 36px; border-radius: 50%;
            display: flex; align-items: center; justify-content: center;
            color: #fff; font-weight: 700; font-size: 12px; flex-shrink: 0;
        }
        .instructor-name { font-weight: 600; font-size: 13px; color: var(--slate-800); }
        .instructor-role { font-size: 11px; color: var(--slate-500); }

        .card-section-title {
            font-size: 9px; font-weight: 700; text-transform: uppercase; letter-spacing: .08em;
            color: var(--slate-400); margin-bottom: 3px;
            display: flex; align-items: center; gap: 4px;
        }
        .card-desc { font-size: 12.5px; color: var(--slate-600); line-height: 1.5; margin-bottom: 12px; }

        .card-footer {
            display: flex; align-items: center; justify-content: space-between;
            padding-top: 12px; border-top: 1px solid var(--slate-100);
        }
        .card-meta { display: flex; gap: 10px; font-size: 11px; color: var(--slate-500); }
        .card-meta span { display: inline-flex; align-items: center; gap: 3px; }
        .card-cta { font-size: 13px; font-weight: 700; transition: color var(--transition-base); }
        .course-card.selected .card-cta { color: var(--emerald-500); }

        /* Tablet (>=640px): grid layout, no tabs */
        @media (min-width: 640px) {
            .tabs-label { display: none; }
            .course-tabs { display: none; }
            .tab-arrow { display: none; }
            .cards-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 16px; }
            .course-card { display: block !important; border-color: transparent; border-radius: var(--radius-xl); }
            .course-card:active { transform: none; }
            .course-card:hover { transform: translateY(-3px); box-shadow: var(--shadow-card-hover); }
            .card-head { padding: 20px 20px 16px; }
            .card-check { width: 32px; height: 32px; top: 12px; right: 12px; }
            .card-check svg { width: 18px; height: 18px; }
            .card-tag { padding: 3px 10px; font-size: 11px; margin-bottom: 8px; }
            .card-head h3 { font-size: 18px; }
            .card-head p { font-size: 13px; }
            .card-body { padding: 20px; }
            .instructor { gap: 12px; padding-bottom: 16px; margin-bottom: 16px; }
            .instructor-avatar { width: 40px; height: 40px; font-size: 13px; }
            .instructor-name { font-size: 14px; }
            .instructor-role { font-size: 12px; }
            .card-section-title { font-size: 10px; margin-bottom: 4px; }
            .card-desc { font-size: 13px; line-height: 1.55; margin-bottom: 14px; }
            .card-footer { padding-top: 14px; }
            .card-meta { gap: 12px; font-size: 12px; }
            .card-meta span { gap: 3px; }
            .card-cta { font-size: 12px; }
        }

        /* ═══════════════════════════════════════════
           NAV BUTTONS — Mobile: full-width stacked
        ═══════════════════════════════════════════ */
        .nav-row {
            display: flex; flex-direction: column-reverse; gap: 8px; margin-top: 24px;
        }
        .btn {
            padding: 12px 16px; border-radius: 12px; font-weight: 600; font-size: 14px;
            transition: all var(--transition-base); display: flex; align-items: center;
            justify-content: center; gap: 6px; width: 100%;
            -webkit-tap-highlight-color: transparent;
            /* min touch target */
            min-height: 48px;
        }
        .btn-ghost { background: var(--slate-100); color: var(--slate-600); }
        .btn-ghost:active { background: var(--slate-200); }
        .btn-primary { background: var(--sky-500); color: #fff; box-shadow: 0 2px 8px rgba(6,147,227,.3); }
        .btn-primary:active { background: var(--navy-800); }
        .btn-success { background: var(--emerald-500); color: #fff; box-shadow: 0 2px 8px rgba(0,208,132,.3); }
        .btn-success:active { background: var(--emerald-600); }
        .btn-dark { background: var(--slate-800); color: #fff; }
        .btn-dark:active { background: var(--slate-700); }
        .btn-row-right { display: flex; flex-direction: column; gap: 8px; width: 100%; }
        .nav-stack { display: flex; flex-direction: column; gap: 8px; margin-top: 24px; }

        @media (min-width: 640px) {
            .nav-row { flex-direction: row; justify-content: space-between; align-items: center; margin-top: 32px; }
            .nav-stack { flex-direction: row; margin-top: 32px; }
            .btn { width: auto; padding: 10px 20px; min-height: unset; display: inline-flex; }
            .btn-primary:hover { transform: translateY(-1px); box-shadow: 0 4px 12px rgba(6,147,227,.35); }
            .btn-success:hover { transform: translateY(-1px); }
            .btn-ghost:hover { background: var(--slate-200); }
            .btn-dark:hover { background: var(--slate-700); }
            .btn-row-right { flex-direction: row; width: auto; }
        }

        /* ═══════════════════════════════════════════
           FORM (Step 6) — Mobile base
        ═══════════════════════════════════════════ */
        .form-wrapper { margin: 0 auto; }
        .form-summary {
            background: #ecfdf5; border: 1px solid #a7f3d0; border-radius: var(--radius-lg);
            padding: 14px 16px; margin-bottom: 20px;
        }
        .form-summary h4 { font-weight: 700; color: #065f46; font-size: 13px; margin-bottom: 6px; }
        .form-summary-row {
            display: flex; justify-content: space-between; padding: 3px 0; font-size: 12px; color: #047857;
            gap: 8px;
        }
        .form-summary-row strong { font-weight: 600; text-align: right; }

        .form-card {
            background: #fff; border-radius: var(--radius-lg); box-shadow: var(--shadow-card);
            padding: 20px; border: 1px solid var(--slate-200);
        }
        .form-group { margin-bottom: 16px; }
        .form-group:last-child { margin-bottom: 0; }
        .form-label { display: block; font-size: 13px; font-weight: 600; color: var(--slate-700); margin-bottom: 5px; }
        .form-label .req { color: var(--red-500); }
        .form-input {
            width: 100%; padding: 12px 14px; font-size: 16px; /* 16px prevents iOS zoom */
            background: var(--slate-50); border: 1.5px solid var(--slate-200);
            border-radius: 10px; color: var(--slate-800);
            transition: all var(--transition-base); outline: none;
            -webkit-appearance: none;
        }
        .form-input:focus { border-color: var(--sky-500); box-shadow: 0 0 0 3px rgba(6,147,227,.12); background: #fff; }
        .form-input.error { border-color: var(--red-500); box-shadow: 0 0 0 3px rgba(239,68,68,.1); }
        .form-input-hint { font-size: 11px; color: var(--red-500); margin-top: 3px; display: none; }
        .form-input.error + .form-input-hint { display: block; }
        .form-row { display: grid; grid-template-columns: 1fr; gap: 0; } /* stacked on mobile */
        select.form-input {
            appearance: none; -webkit-appearance: none;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' fill='%2394a3b8' viewBox='0 0 16 16'%3E%3Cpath d='M4 6l4 4 4-4'/%3E%3C/svg%3E");
            background-repeat: no-repeat; background-position: right 12px center; padding-right: 36px;
        }

        @media (min-width: 640px) {
            .form-wrapper { max-width: 560px; }
            .form-card { padding: 28px; border-radius: var(--radius-xl); }
            .form-summary { padding: 16px 20px; margin-bottom: 24px; }
            .form-summary h4 { font-size: 14px; }
            .form-summary-row { font-size: 13px; }
            .form-input { padding: 10px 14px; font-size: 14px; }
            .form-row { grid-template-columns: 1fr 1fr; gap: 14px; }
        }

        /* ═══════════════════════════════════════════
           CONFIRM (Step 7) — Mobile base
        ═══════════════════════════════════════════ */
        .confirm-wrapper { margin: 0 auto; }
        .confirm-card {
            background: #fff; border-radius: var(--radius-lg); box-shadow: var(--shadow-card);
            padding: 20px; margin-bottom: 16px; border: 1px solid var(--slate-200);
        }
        .confirm-section-title { font-weight: 700; font-size: 14px; color: var(--slate-800); margin-bottom: 10px; display: flex; align-items: center; gap: 6px; }
        .confirm-course-row {
            display: flex; justify-content: space-between; align-items: center;
            padding: 8px 10px; background: var(--slate-50); border-radius: 8px; margin-bottom: 6px;
            font-size: 12px; gap: 8px;
        }
        .confirm-course-row .turno { color: var(--slate-500); font-weight: 500; flex-shrink: 0; }
        .confirm-course-row .name { font-weight: 600; color: var(--slate-800); text-align: right; }
        .confirm-data-row { font-size: 13px; padding: 4px 0; display: flex; gap: 8px; }
        .confirm-data-row .label { color: var(--slate-500); min-width: 70px; flex-shrink: 0; }
        .confirm-data-row .value { color: var(--slate-800); font-weight: 500; word-break: break-word; }

        .terms-label {
            display: flex; align-items: flex-start; gap: 12px; cursor: pointer;
            background: var(--slate-50); border: 1px solid var(--slate-200);
            padding: 14px 16px; border-radius: var(--radius-lg); margin-bottom: 16px;
            transition: all var(--transition-base);
            -webkit-tap-highlight-color: transparent;
        }
        .terms-label:active { border-color: var(--slate-300); background: var(--slate-100); }
        .terms-label input { width: 22px; height: 22px; margin-top: 1px; accent-color: var(--emerald-500); flex-shrink: 0; }
        .terms-label span { font-size: 12.5px; color: var(--slate-600); line-height: 1.5; }

        /* Inline edit buttons */
        .confirm-section-header { display: flex; align-items: center; justify-content: space-between; margin-bottom: 10px; }
        .confirm-section-header .confirm-section-title { margin-bottom: 0; }
        .btn-edit-section {
            font-size: 11px; font-weight: 600; color: var(--sky-500); background: none; border: none;
            cursor: pointer; display: flex; align-items: center; gap: 4px; padding: 4px 8px;
            border-radius: 6px; transition: all var(--transition-base);
        }
        .btn-edit-section:active { background: var(--slate-100); }
        .btn-edit-section .icon { width: 13px; height: 13px; }
        .btn-edit-section .icon svg { stroke: var(--sky-500); }

        /* Editable data row */
        .confirm-data-row { position: relative; }
        .confirm-data-row.editing .value { display: none; }
        .confirm-data-row .edit-input {
            display: none; font-size: 13px; font-weight: 500; color: var(--slate-800);
            border: 1.5px solid var(--sky-400); border-radius: 6px; padding: 4px 8px;
            background: #fff; outline: none; width: 100%; font-family: inherit;
        }
        .confirm-data-row.editing .edit-input { display: block; }
        .confirm-data-row .edit-input:focus { box-shadow: 0 0 0 3px rgba(6,147,227,.15); }

        /* Editable course row */
        .confirm-course-row { position: relative; cursor: default; }
        .confirm-course-row .btn-change-course {
            font-size: 11px; font-weight: 600; color: var(--sky-500); background: none; border: none;
            cursor: pointer; padding: 2px 6px; border-radius: 4px; white-space: nowrap;
            transition: all var(--transition-base); display: none;
        }
        .confirm-course-row .btn-change-course:active { background: rgba(6,147,227,.1); }
        .editing-courses .confirm-course-row .btn-change-course { display: inline; }
        .editing-courses .confirm-course-row .name { flex: 1; }

        /* Editable select for course (inline dropdown) */
        .confirm-course-row .course-select {
            display: none; font-size: 12px; font-weight: 500; color: var(--slate-800);
            border: 1.5px solid var(--sky-400); border-radius: 6px; padding: 4px 6px;
            background: #fff; outline: none; flex: 1; font-family: inherit; max-width: 200px;
        }
        .confirm-course-row .course-select:focus { box-shadow: 0 0 0 3px rgba(6,147,227,.15); }
        .confirm-course-row.picking .name { display: none; }
        .confirm-course-row.picking .btn-change-course { display: none !important; }
        .confirm-course-row.picking .course-select { display: block; }

        @media (min-width: 640px) {
            .confirm-wrapper { max-width: 560px; }
            .confirm-card { padding: 28px; margin-bottom: 20px; border-radius: var(--radius-xl); }
            .confirm-section-title { font-size: 15px; margin-bottom: 12px; }
            .confirm-section-header .confirm-section-title { margin-bottom: 0; }
            .confirm-course-row { font-size: 13px; padding: 8px 12px; }
            .confirm-data-row .label { min-width: 80px; }
            .btn-edit-section { font-size: 12px; }
            .btn-edit-section:hover { background: var(--slate-100); }
            .confirm-course-row .btn-change-course:hover { background: rgba(6,147,227,.1); }
            .terms-label:hover { border-color: var(--slate-300); }
            .terms-label input { width: 20px; height: 20px; }
            .terms-label span { font-size: 13px; }
        }

        /* ═══════════════════════════════════════════
           SUCCESS — Mobile base
        ═══════════════════════════════════════════ */
        .success-wrapper { margin: 0 auto; text-align: center; padding: 24px 0; }
        .success-icon {
            width: 68px; height: 68px; border-radius: 50%; margin: 0 auto 16px;
            background: linear-gradient(135deg, #d1fae5, #a7f3d0);
            display: flex; align-items: center; justify-content: center; font-size: 30px;
            animation: pop-in .5s cubic-bezier(.34,1.56,.64,1);
        }
        @keyframes pop-in { from { transform: scale(0); } to { transform: scale(1); } }
        .success-title { font-family: var(--font-display); font-size: 22px; color: var(--slate-800); margin-bottom: 6px; }
        .success-sub { color: var(--slate-500); font-size: 14px; margin-bottom: 24px; }
        .success-box {
            background: #fff; border-radius: var(--radius-lg); box-shadow: var(--shadow-card);
            padding: 20px; text-align: left; margin-bottom: 12px; border: 1px solid var(--slate-200);
        }
        .success-box h4 { font-weight: 700; font-size: 13px; color: var(--slate-800); margin-bottom: 10px; display: flex; align-items: center; gap: 6px; }
        .success-steps { font-size: 12.5px; color: var(--slate-600); }
        .success-steps li { padding: 3px 0; list-style: none; }
        .success-steps li::before { content: '→ '; color: var(--emerald-500); font-weight: 700; }

        @media (min-width: 640px) {
            .success-wrapper { max-width: 540px; padding: 32px 0; }
            .success-icon { width: 80px; height: 80px; font-size: 36px; margin-bottom: 20px; }
            .success-title { font-size: 28px; margin-bottom: 8px; }
            .success-sub { font-size: 15px; margin-bottom: 28px; }
            .success-box { padding: 24px; margin-bottom: 16px; border-radius: var(--radius-xl); }
            .success-box h4 { font-size: 14px; }
            .success-steps { font-size: 13px; }
        }

        /* ═══════════════════════════════════════════
           CONFETTI
        ═══════════════════════════════════════════ */
        .confetti {
            position: fixed; width: 8px; height: 8px; top: -12px;
            animation: confetti-fall 3.5s cubic-bezier(.25,.46,.45,.94) forwards;
            z-index: 9999; pointer-events: none;
        }
        @keyframes confetti-fall {
            0% { transform: translateY(0) rotate(0deg) scale(1); opacity: 1; }
            80% { opacity: 1; }
            100% { transform: translateY(105vh) rotate(720deg) scale(.6); opacity: 0; }
        }

        /* ═══════════════════════════════════════════
           TOAST — Mobile base (wider, centered)
        ═══════════════════════════════════════════ */
        .toast {
            position: fixed; top: 64px; left: 12px; right: 12px;
            transform: translateY(-16px);
            background: var(--slate-800); color: #fff; padding: 12px 16px;
            border-radius: 12px; font-size: 13px; font-weight: 500;
            box-shadow: 0 8px 24px rgba(0,0,0,.2); z-index: 200;
            opacity: 0; transition: all .3s ease; pointer-events: none;
            text-align: center;
        }
        .toast.show { opacity: 1; transform: translateY(0); }
        .toast.warn { background: #b45309; }
        .toast.error { background: #CC3366; }
        .toast.success { background: #059669; }

        @media (min-width: 640px) {
            .toast {
                left: 50%; right: auto; transform: translateX(-50%) translateY(-20px);
                width: auto; max-width: 400px; padding: 10px 20px;
            }
            .toast.show { transform: translateX(-50%) translateY(0); }
        }

        /* ═══════════════════════════════════════════
           COLOR THEMES FOR CARDS (6 cores institucionais)
        ═══════════════════════════════════════════ */
        .theme-blue { background: linear-gradient(135deg, #004a80, #0693e3); }
        .theme-emerald { background: linear-gradient(135deg, #00a86b, #00d084); }
        .theme-violet { background: linear-gradient(135deg, #9b51e0, #b07ce8); }
        .theme-amber { background: linear-gradient(135deg, #8B1A2B, #A52240); }
        .theme-teal { background: linear-gradient(135deg, #10517f, #2878b5); }
        .theme-rose { background: linear-gradient(135deg, #CC3366, #e04878); }

        /* ═══════════════════════════════════════════
           ICON SYSTEM (SVG inline)
        ═══════════════════════════════════════════ */
        .icon { display: inline-flex; align-items: center; justify-content: center; width: 1em; height: 1em; vertical-align: -0.125em; flex-shrink: 0; }
        .icon svg { width: 100%; height: 100%; fill: none; stroke: currentColor; stroke-width: 2; stroke-linecap: round; stroke-linejoin: round; }
        .icon-lg { width: 1.25em; height: 1.25em; }
        .prog-circle .icon { width: 16px; height: 16px; }
        .prog-circle .icon svg { stroke-width: 2.5; }

        /* ═══════════════════════════════════════════
           HERO CTA BUTTON
        ═══════════════════════════════════════════ */
        .btn-hero {
            background: var(--amber-400); color: #fff; font-weight: 700;
            padding: 14px 28px; border-radius: 12px; font-size: 15px;
            margin-top: 20px; display: inline-flex; align-items: center; gap: 8px;
            box-shadow: 0 4px 16px rgba(139,26,43,.3);
            transition: all var(--transition-base);
        }
        .btn-hero:hover { transform: translateY(-2px); box-shadow: 0 6px 24px rgba(139,26,43,.4); }
        .btn-hero:active { transform: scale(.98); }

        /* ═══════════════════════════════════════════
           COUNTDOWN
        ═══════════════════════════════════════════ */
        .countdown {
            display: flex; justify-content: center; gap: 10px;
            margin-top: 20px; margin-bottom: 4px;
        }
        .countdown-item {
            display: flex; flex-direction: column; align-items: center;
            background: rgba(255,255,255,.08); border: 1px solid rgba(255,255,255,.1);
            border-radius: 12px; padding: 10px 14px; min-width: 60px;
        }
        .countdown-num {
            font-family: var(--font-display); font-size: 24px; font-weight: 800;
            color: #fff; line-height: 1;
        }
        .countdown-label {
            font-size: 9px; text-transform: uppercase; letter-spacing: .08em;
            color: rgba(255,255,255,.5); margin-top: 4px; font-weight: 600;
        }
        .countdown-sep {
            font-size: 22px; font-weight: 700; color: rgba(255,255,255,.3);
            align-self: center; padding-bottom: 12px;
        }
        .countdown-expired {
            color: var(--amber-400); font-weight: 700; font-size: 14px;
            margin-top: 20px; margin-bottom: 4px;
        }
        @media (min-width: 640px) {
            .countdown { gap: 12px; }
            .countdown-item { padding: 12px 18px; min-width: 72px; }
            .countdown-num { font-size: 30px; }
            .countdown-label { font-size: 10px; }
        }

        /* ═══════════════════════════════════════════
           BENEFITS — Stats highlight
        ═══════════════════════════════════════════ */
        .benefits-stats {
            display: flex; justify-content: center; gap: 24px;
            margin-bottom: 28px; flex-wrap: wrap;
        }
        .stat-item {
            text-align: center; padding: 0 8px;
        }
        .stat-num {
            font-family: var(--font-display); font-size: 32px; font-weight: 800;
            color: var(--navy-800); line-height: 1;
        }
        .stat-label {
            font-size: 11px; color: var(--slate-500); font-weight: 600;
            text-transform: uppercase; letter-spacing: .04em; margin-top: 4px;
        }
        .stat-divider {
            width: 1px; background: var(--slate-200); align-self: stretch;
        }
        @media (min-width: 640px) {
            .benefits-stats { gap: 40px; margin-bottom: 36px; }
            .stat-num { font-size: 40px; }
            .stat-label { font-size: 12px; }
        }

        /* ═══════════════════════════════════════════
           FOOTER
        ═══════════════════════════════════════════ */
        .site-footer {
            background: var(--navy-900); color: rgba(255,255,255,.7);
            padding: 40px 16px 0; margin-top: 0;
        }
        .footer-inner {
            max-width: 1100px; margin: 0 auto;
            display: grid; grid-template-columns: 1fr; gap: 28px;
            padding-bottom: 28px;
        }
        .footer-logo { height: 40px; width: auto; margin-bottom: 10px; filter: brightness(0) invert(1); }
        .footer-brand p { font-size: 14px; color: rgba(255,255,255,.85); font-weight: 600; margin-bottom: 4px; }
        .footer-brand small { font-size: 12px; color: rgba(255,255,255,.5); }
        .footer-links h4, .footer-contact h4 {
            font-size: 12px; font-weight: 700; text-transform: uppercase; letter-spacing: .06em;
            color: rgba(255,255,255,.4); margin-bottom: 12px;
        }
        .footer-links a {
            display: block; color: rgba(255,255,255,.7); text-decoration: none;
            font-size: 13px; padding: 4px 0; transition: color var(--transition-base);
        }
        .footer-links a:hover { color: #fff; }
        .footer-contact p { font-size: 13px; margin-bottom: 4px; }
        .footer-bottom {
            border-top: 1px solid rgba(255,255,255,.08);
            padding: 16px 0; text-align: center;
            font-size: 12px; color: rgba(255,255,255,.35);
        }
        @media (min-width: 640px) {
            .site-footer { padding: 48px 24px 0; }
            .footer-inner { grid-template-columns: 2fr 1fr 1fr; gap: 40px; padding-bottom: 36px; }
        }

        /* ═══════════════════════════════════════════
           SPINNER (loading state)
        ═══════════════════════════════════════════ */
        .spinner {
            display: inline-block; width: 18px; height: 18px;
            border: 2.5px solid rgba(255,255,255,.3); border-top-color: #fff;
            border-radius: 50%; animation: spin .6s linear infinite;
        }
        @keyframes spin { to { transform: rotate(360deg); } }
        .btn[disabled] { opacity: .7; cursor: not-allowed; pointer-events: none; }

        /* ═══════════════════════════════════════════
           ADMIN UPLOAD PANEL (visible only with ?admin=1)
        ═══════════════════════════════════════════ */
        .admin-panel {
            display: none; position: fixed; top: 70px; right: 16px; z-index: 200;
            background: #fff; border-radius: var(--radius-lg); box-shadow: var(--shadow-float);
            padding: 20px; width: 300px; border: 2px solid var(--sky-500);
        }
        .admin-panel.visible { display: block; }
        .admin-panel h3 { font-size: 15px; margin-bottom: 8px; color: var(--navy-800); }
        .admin-hint { font-size: 12px; color: var(--slate-500); margin-bottom: 12px; line-height: 1.4; }
        .admin-drop-zone {
            border: 2px dashed var(--slate-300); border-radius: 12px; padding: 20px 12px;
            text-align: center; cursor: pointer; transition: var(--transition-base); margin-bottom: 10px;
        }
        .admin-drop-zone:hover, .admin-drop-zone.dragover { border-color: var(--sky-500); background: #f0f9ff; }
        .admin-drop-zone input[type="file"] { display: none; }
        .admin-drop-zone p { font-size: 12px; color: var(--slate-500); line-height: 1.4; }
        .admin-drop-icon { font-size: 28px; margin-bottom: 6px; color: var(--slate-400); }
        .admin-status { font-size: 12px; padding: 8px 10px; border-radius: 8px; margin-top: 8px; line-height: 1.4; }
        .admin-status.success { background: #d1fae5; color: #065f46; }
        .admin-status.error { background: #fce4ea; color: #8B1A2B; }
        .admin-btn-row { display: flex; gap: 6px; margin-top: 10px; }
        .admin-btn-row .btn { flex: 1; font-size: 11px; padding: 7px 8px; }
        @media (max-width: 639px) {
            .admin-panel { right: 8px; left: 8px; width: auto; top: 62px; }
        }
    </style>
</head>
<body>

<!-- ════════ TOAST ════════ -->
<div class="toast" id="toast"></div>

<!-- ════════ HEADER ════════ -->
<header class="site-header">
    <div class="header-inner">
        <div class="logo-group">
            <img src="logo-tcmpa.png" alt="TCM-PA" class="logo-img">
        </div>
        <div class="header-badge">Março 2026 — Bragança</div>
    </div>
</header>

<!-- ════════ HERO ════════ -->
<section class="hero">
    <!-- Video background: replace hero-bg.mp4 with your video file -->
    <video class="hero-video" autoplay muted loop playsinline preload="auto"
           oncanplaythrough="this.classList.add('loaded')"
           onerror="this.style.display='none'">
        <source src="hero-bg.mp4" type="video/mp4">
    </video>
    <div class="hero-overlay"></div>
    <div class="hero-inner">
        <div class="hero-badge">
            <div class="dot"></div>
            <span>Inscrições Abertas</span>
        </div>
        <h1>Semana de Capacitação <em>Bragança 2026</em></h1>
        <p>Monte sua trilha personalizada! Escolha os cursos que mais se encaixam no seu perfil, com mínimo de 1 curso obrigatório.</p>
        <div class="hero-tags">
            <div class="hero-tag"><span class="icon"><svg viewBox="0 0 24 24"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg></span> 09 de Março</div>
            <div class="hero-tag"><span class="icon"><svg viewBox="0 0 24 24"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg></span> 8 Turnos disponíveis</div>
            <div class="hero-tag highlight"><span class="icon"><svg viewBox="0 0 24 24"><polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"/></svg></span> Mínimo 1 curso</div>
        </div>
        <div class="countdown" id="countdown"></div>
        <button class="btn btn-hero" onclick="document.getElementById('step-1').scrollIntoView({behavior:'smooth'})">Iniciar Inscrição <span class="icon"><svg viewBox="0 0 24 24"><line x1="5" y1="12" x2="19" y2="12"/><polyline points="12 5 19 12 12 19"/></svg></span></button>
    </div>
</section>

<!-- ════════ BENEFITS ════════ -->
<section class="benefits">
    <div class="benefits-inner">
        <h2 class="benefits-title">Por que participar?</h2>
        <p class="benefits-sub">A Semana de Capacitação em Bragança prepara servidores para os desafios da gestão pública municipal.</p>

        <div class="benefits-stats">
            <div class="stat-item">
                <div class="stat-num">21</div>
                <div class="stat-label">Cursos disponíveis</div>
            </div>
            <div class="stat-divider"></div>
            <div class="stat-item">
                <div class="stat-num">8</div>
                <div class="stat-label">Turnos em 5 dias</div>
            </div>
            <div class="stat-divider"></div>
            <div class="stat-item">
                <div class="stat-num">82h</div>
                <div class="stat-label">De conteúdo prático</div>
            </div>
            <div class="stat-divider"></div>
            <div class="stat-item">
                <div class="stat-num">100%</div>
                <div class="stat-label">Voltado à prática</div>
            </div>
        </div>

        <div class="benefits-grid">
            <div class="benefit-card">
                <div class="benefit-icon" style="background: linear-gradient(135deg, #004a80, #0693e3)">
                    <span class="icon"><svg viewBox="0 0 24 24"><rect x="3" y="3" width="5" height="5" rx="1"/><rect x="10" y="3" width="5" height="5" rx="1"/><rect x="17" y="3" width="5" height="5" rx="1"/><rect x="3" y="10" width="5" height="5" rx="1"/><rect x="10" y="10" width="5" height="5" rx="1"/><rect x="17" y="10" width="5" height="5" rx="1"/><rect x="3" y="17" width="5" height="5" rx="1"/><rect x="10" y="17" width="5" height="5" rx="1"/><rect x="17" y="17" width="5" height="5" rx="1"/></svg></span>
                </div>
                <div class="benefit-text">
                    <h3>15 Cursos para Escolher</h3>
                    <p>Amplo leque de opções em controle interno, licitações, contabilidade, prestação de contas, transparência e muito mais.</p>
                </div>
            </div>
            <div class="benefit-card">
                <div class="benefit-icon" style="background: linear-gradient(135deg, #8B1A2B, #A52240)">
                    <span class="icon"><svg viewBox="0 0 24 24"><circle cx="12" cy="12" r="10"/><circle cx="12" cy="12" r="6"/><circle cx="12" cy="12" r="2"/></svg></span>
                </div>
                <div class="benefit-text">
                    <h3>Foco na Prática Municipal</h3>
                    <p>Estudos de caso reais de municípios paraenses, simulações de processos e roteiros práticos para aplicar imediatamente no seu trabalho.</p>
                </div>
            </div>
            <div class="benefit-card">
                <div class="benefit-icon" style="background: linear-gradient(135deg, #00a86b, #00d084)">
                    <span class="icon"><svg viewBox="0 0 24 24"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg></span>
                </div>
                <div class="benefit-text">
                    <h3>Instrutores do TCM-PA</h3>
                    <p>Auditores, analistas e especialistas com vivência direta na fiscalização dos municípios do Pará.</p>
                </div>
            </div>
            <div class="benefit-card">
                <div class="benefit-icon" style="background: linear-gradient(135deg, #9b51e0, #b07ce8)">
                    <span class="icon"><svg viewBox="0 0 24 24"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/></svg></span>
                </div>
                <div class="benefit-text">
                    <h3>Prevenção de Irregularidades</h3>
                    <p>Aprenda a identificar e evitar erros comuns que geram ressalvas e apontamentos nas auditorias do TCM-PA.</p>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- ════════ PROGRESS BAR ════════ -->
<nav class="progress-bar" id="progressBar">
    <div class="progress-inner" id="progressInner">
        <!-- Generated by JS -->
    </div>
</nav>

<!-- ════════ FLOATING COUNTER ════════ -->
<div class="float-counter" id="floatCounter" style="display:none">
    <div class="float-counter-label">Selecionados</div>
    <div class="float-counter-num"><span id="counterNum">0</span><small> / <span id="counterMax">5</span></small></div>
    <div class="float-counter-status warn" id="counterStatus">Mín: 1 curso</div>
</div>

<!-- ════════ ADMIN UPLOAD PANEL ════════ -->
<div class="admin-panel" id="adminPanel">
    <h3>Atualizar Cursos</h3>
    <p class="admin-hint">Envie um arquivo JSON ou CSV para atualizar o site para todos os visitantes.</p>
    <div class="admin-token-row" id="adminTokenRow">
        <label style="font-size:12px;color:var(--slate-500)">Token GitHub (necessário para publicar):</label>
        <input type="password" id="adminGhToken" placeholder="ghp_..." style="width:100%;padding:6px 8px;border:1px solid var(--slate-300);border-radius:6px;font-size:13px;margin:4px 0 8px">
        <button class="btn btn-ghost" onclick="saveGhToken()" style="font-size:12px">Salvar token</button>
    </div>
    <div class="admin-drop-zone" id="adminDropZone" onclick="document.getElementById('adminFileInput').click()">
        <div class="admin-drop-icon"><span class="icon" style="width:28px;height:28px"><svg viewBox="0 0 24 24"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="17 8 12 3 7 8"/><line x1="12" y1="3" x2="12" y2="15"/></svg></span></div>
        <p>Arraste um arquivo aqui<br>ou clique para selecionar<br><small style="color:var(--slate-400)">.json ou .csv</small></p>
        <input type="file" id="adminFileInput" accept=".json,.csv">
    </div>
    <div id="adminStatus"></div>
    <div class="admin-btn-row">
        <button class="btn btn-ghost" onclick="exportCurrentJSON()">Exportar JSON</button>
        <button class="btn btn-ghost" onclick="downloadCSVTemplate()">Modelo CSV</button>
    </div>
    <div class="admin-btn-row">
        <button class="btn btn-ghost" onclick="resetToDefaults()" style="color:var(--red-500)">Restaurar Padrão</button>
    </div>
</div>

<!-- ════════ MAIN ════════ -->
<main class="main-content">
    <!-- Panels are generated by JS from data -->
    <div id="panelsContainer"></div>
</main>

<!-- ════════ FOOTER ════════ -->
<footer class="site-footer">
    <div class="footer-inner">
        <div class="footer-brand">
            <img src="logo-tcmpa.png" alt="TCM-PA" class="footer-logo">
            <p>Escola de Contas do TCM-PA</p>
            <small>Capacitando servidores para uma gestão pública de excelência.</small>
        </div>
        <div class="footer-links">
            <h4>Links Úteis</h4>
            <a href="https://www.tcm.pa.gov.br" target="_blank">Portal TCM-PA</a>
            <a href="#">Legislação</a>
            <a href="#">Escola de Contas</a>
            <a href="#">Contato</a>
        </div>
        <div class="footer-contact">
            <h4>Contato</h4>
            <p>Travessa Quintino Bocaiúva, s/n</p>
            <p>Belém — PA, 66053-240</p>
            <p style="margin-top:8px">escola@tcm.pa.gov.br</p>
        </div>
    </div>
    <div class="footer-bottom">
        <p>&copy; 2026 Tribunal de Contas dos Municípios do Estado do Pará. Todos os direitos reservados.</p>
    </div>
</footer>

<script>
/* ═══════════════════════════════════════════
   DATA
═══════════════════════════════════════════ */
let TURNOS = [
    {
        id: 1, label: 'Turno 1', shortLabel: 'Seg Tarde',
        badge: 'Seg • 01/06 • Tarde (14h–18h)', badgeBg: '#e0effa', badgeColor: '#004a80',
        courses: [
            {
                id: 'c1-1', name: 'Geral', theme: 'theme-blue', tag: 'Geral',
                title: 'ABERTURA', subtitle: 'Cenário 2026',
                instructor: 'Sérgio Leão', instrRole: 'Diretor Executivo da Escola de Contas Públicas "Conselheiro Irawaldyr Rocha"', instrInitials: 'SL', instrTheme: 'theme-blue',
                desc: '',
                publico: 'Presencial',
                duracao: '4h', vagas: 50, ctaColor: '#004a80'
            }
        ]
    },
    {
        id: 2, label: 'Turno 2', shortLabel: 'Ter Manhã',
        badge: 'Ter • 02/06 • Manhã (8h30–12h30)', badgeBg: '#fce4ea', badgeColor: '#8B1A2B',
        courses: [
            {
                id: 'c2-1', name: 'Gestão e Finanças', theme: 'theme-amber', tag: 'Gestão e Finanças',
                title: 'REFORMA TRIBUTÁRIA', subtitle: 'IBS/CBS',
                instructor: 'René de Oliveira e Sousa Jr', instrRole: 'Secretário de Fazenda do Pará', instrInitials: 'RO', instrTheme: 'theme-amber',
                desc: '',
                publico: 'Presencial',
                duracao: '4h', vagas: 50, ctaColor: '#8B1A2B'
            },
            {
                id: 'c2-2', name: 'Controle e Contas', theme: 'theme-teal', tag: 'Controle e Contas',
                title: 'Controle Interno: Gestão de Riscos e Boas Práticas para Servidores Municipais', subtitle: 'Identificação e avaliação de riscos',
                instructor: 'Aristides Gomes Neto', instrRole: 'Auditor de Controle Externo (TCMPA)', instrInitials: 'AG', instrTheme: 'theme-teal',
                desc: 'Capacitar servidores a identificar, avaliar e mitigar riscos no cotidiano, incorporando rotinas de Controle Interno como prática natural do trabalho.',
                publico: 'Servidores que atuem na área de controle interno das prefeituras e câmaras municipais.',
                duracao: '4h', vagas: 50, ctaColor: '#10517f'
            },
            {
                id: 'c2-3', name: 'Políticas Públicas', theme: 'theme-rose', tag: 'Políticas Públicas',
                title: 'Do papel ao orçamento: como viabilizar o PMPI no município', subtitle: 'Estruturação do PMPI',
                instructor: 'Márcia Costa', instrRole: 'Conselheira Substituta (TCMPA)', instrInitials: 'MC', instrTheme: 'theme-rose',
                desc: 'Capacitar os participantes para estruturar, revisar e viabilizar o Plano Municipal da Primeira Infância - PMPI.',
                publico: 'Secretários, diretores, coordenadores, técnicos e assessores das secretarias municipais de Educação, Saúde, Assistência Social, Planejamento e Orçamento; membros dos Conselhos de Direitos da Criança e do Adolescente e integrantes de comitês intersetoriais da primeira infância.',
                duracao: '4h', vagas: 50, ctaColor: '#CC3366'
            }
        ]
    },
    {
        id: 3, label: 'Turno 3', shortLabel: 'Ter Tarde',
        badge: 'Ter • 02/06 • Tarde (14h–18h)', badgeBg: '#fce4ee', badgeColor: '#991f4d',
        courses: [
            {
                id: 'c3-1', name: 'Gestão e Finanças', theme: 'theme-blue', tag: 'Gestão e Finanças',
                title: 'EMENDAS PARLAMENTARES IMPOSITIVAS MUNICIPAIS: da Instituição à Prestação de Contas', subtitle: 'Emendas impositivas municipais',
                instructor: 'Erika Maestri', instrRole: 'Auditora de Controle Externo (TCMPA)', instrInitials: 'EM', instrTheme: 'theme-blue',
                desc: 'Capacitar agentes políticos, servidores públicos e representantes da sociedade civil para a correta aplicação do regime de emendas parlamentares impositivas municipais, em conformidade com a Instrução Normativa n.o 6/2025/TCMPA e a jurisprudência do STF, promovendo uma gestão pública eficiente, transparente e responsável.',
                publico: 'Agentes Políticos (Prefeitos e Vereadores), Servidores Públicos Municipais (Procuradores Jurídicos, Contadores, etc.), Controladores Internos, Representantes de Organizações da Sociedade Civil (OSCs), Sociedade Civil.',
                duracao: '4h', vagas: 50, ctaColor: '#004a80'
            },
            {
                id: 'c3-2', name: 'Controle e Contas', theme: 'theme-emerald', tag: 'Controle e Contas',
                title: 'Prestação de Contas de Convênio', subtitle: 'Gestão de transferências voluntárias',
                instructor: 'A definir', instrRole: 'A definir', instrInitials: 'AD', instrTheme: 'theme-emerald',
                desc: 'Fortalecer a gestão, execução, monitoramento e prestação de contas de transferências voluntárias, por meio de ação integrada, preventiva e pedagógica do TCE-PA e do TCM-PA.',
                publico: 'Prefeitos(as) e Vice-prefeitos(as), Secretários(as) municipais (Administração, Educação, Saúde, Assistência Social), Técnicos das áreas de convênios, contabilidade, controle interno e planejamento e Ordenadores de despesa e fiscais de convênios.',
                duracao: '2h', vagas: 50, ctaColor: '#00a86b'
            },
            {
                id: 'c3-3', name: 'Licitações e Contratos', theme: 'theme-violet', tag: 'Licitações e Contratos',
                title: 'Operação do Sistema Geo-obras e aspectos básicos da execução contratual de obras e serviços públicos de engenharia', subtitle: 'Sistema Geo-obras',
                instructor: 'Ricardo Nunes', instrRole: 'Servidor (TCMPA)', instrInitials: 'RN', instrTheme: 'theme-violet',
                desc: 'Capacitar e reciclar os servidores municipais, usuários do Sistema Geo-obras, sobre sua alimentação e apresentar os principais pontos sobre a execução contratual de obras e serviços públicos de engenharia.',
                publico: 'Servidores municipais responsáveis pela alimentação do Sistema Geo-obras; Servidores municipais responsáveis pelo planejamento e fiscalização das obras e serviços de engenharia.',
                duracao: '4h', vagas: 50, ctaColor: '#9b51e0'
            }
        ]
    },
    {
        id: 4, label: 'Turno 4', shortLabel: 'Qua Manhã',
        badge: 'Qua • 03/06 • Manhã (8h30–12h30)', badgeBg: '#e8f5ec', badgeColor: '#006b44',
        courses: [
            {
                id: 'c4-1', name: 'Controle e Contas', theme: 'theme-amber', tag: 'Controle e Contas',
                title: 'Principais falhas nas Análises de Prestações de Contas e nos Procedimentos Licitatórios e os Prejulgados do TCM/PA', subtitle: 'Pontos de controle obrigatórios',
                instructor: 'Diego Estácio', instrRole: 'Auditor de Controle Externo (TCMPA)', instrInitials: 'DE', instrTheme: 'theme-amber',
                desc: 'Desenvolver nos participantes conhecimentos sobre as principais falhas encontradas nas análises de Prestação de Contas dos ordenadores de despesas.',
                publico: 'Agentes do Poder Executivo e Legislativo municipais, destacadamente os ordenadores de despesas, prefeitos, vereadores, advogados, contadores e responsáveis pelo controle interno.',
                duracao: '2h', vagas: 50, ctaColor: '#8B1A2B'
            },
            {
                id: 'c4-2', name: 'Legislativo', theme: 'theme-teal', tag: 'Legislativo',
                title: 'LEGISLATIVO MUNICIPAL', subtitle: 'Fiscalização',
                instructor: 'Suellem Nascimento', instrRole: 'Auditora de Controle Externo (TCEPA)', instrInitials: 'SN', instrTheme: 'theme-teal',
                desc: '',
                publico: 'Presencial',
                duracao: '4h', vagas: 50, ctaColor: '#10517f'
            },
            {
                id: 'c4-3', name: 'Geral', theme: 'theme-rose', tag: 'Geral',
                title: 'Implementação de Programa de Integridade na Administração Pública Municipal do Estado do Pará e Lei Anticorrupção', subtitle: 'Sistemas de Integridade',
                instructor: 'Marcelo Batista Gonçalves', instrRole: 'Promotor de Justiça - Coordenador do CAODPP', instrInitials: 'MB', instrTheme: 'theme-rose',
                desc: 'Implementação de Sistemas de Integridade e regulamentação da Lei Anticorrupção.',
                publico: 'Autoridades e gestores municipais.',
                duracao: '4h', vagas: 50, ctaColor: '#CC3366'
            },
            {
                id: 'c4-4', name: 'Licitações e Contratos', theme: 'theme-blue', tag: 'Licitações e Contratos',
                title: 'Licitações e Contratações Públicas sob a ótica do Controle Externo', subtitle: 'Visão institucional do TCMPA',
                instructor: 'Arley Dieminger Rodrigues', instrRole: 'Auditor de Controle Externo (TCMPA)', instrInitials: 'AD', instrTheme: 'theme-blue',
                desc: 'Apresentar a visão institucional do TCMPA quanto às licitações e contratações públicas.',
                publico: 'Gestores Municipais, fiscais de contratos e membros das equipes de contratação.',
                duracao: '2h', vagas: 50, ctaColor: '#004a80'
            }
        ]
    },
    {
        id: 5, label: 'Turno 5', shortLabel: 'Qua Tarde',
        badge: 'Qua • 03/06 • Tarde (14h–18h)', badgeBg: '#f3e8ff', badgeColor: '#7b3bb5',
        courses: [
            {
                id: 'c5-1', name: 'Políticas Públicas', theme: 'theme-blue', tag: 'Políticas Públicas',
                title: 'FUNDEB da teoria à prática: planejamento, execução e prestação de contas', subtitle: 'Planejamento do FUNDEB',
                instructor: 'Everaldo Lino Alves', instrRole: 'Auditor de Controle Externo (TCMPA)', instrInitials: 'EL', instrTheme: 'theme-blue',
                desc: 'Fortalecer a capacidade técnica dos gestores e servidores públicos para planejar, executar, controlar e prestar contas corretamente dos recursos do FUNDEB.',
                publico: 'Secretários Municipais de Educação, equipes técnicas, gestores, membros de conselhos escolares, contadores.',
                duracao: '4h', vagas: 50, ctaColor: '#004a80'
            },
            {
                id: 'c5-2', name: 'Gestão e Finanças', theme: 'theme-emerald', tag: 'Gestão e Finanças',
                title: 'RECEITAS PRÓPRIAS + SIAFIC', subtitle: 'Sistemas',
                instructor: 'Luiz Fernando Gonçalves da Costa', instrRole: 'Auditor de Controle Externo (TCMPA)', instrInitials: 'LF', instrTheme: 'theme-emerald',
                desc: '',
                publico: 'Presencial',
                duracao: '4h', vagas: 50, ctaColor: '#00a86b'
            },
            {
                id: 'c5-3', name: 'Licitações e Contratos', theme: 'theme-violet', tag: 'Licitações e Contratos',
                title: 'Aplicação prática da Lei de Licitações na fase preparatória e na gestão e fiscalização de contratos', subtitle: 'Plano de Compras Anual (PCA)',
                instructor: 'Rosana Gama', instrRole: 'Auditora de Controle Externo (TCMPA)', instrInitials: 'RG', instrTheme: 'theme-violet',
                desc: 'Capacitar os participantes em relação à elaboração do Plano de Compras Anual (PCA).',
                publico: 'Servidores públicos que atuam na área de planejamento, administração, compras, licitações, contratos.',
                duracao: '4h', vagas: 50, ctaColor: '#9b51e0'
            }
        ]
    },
    {
        id: 6, label: 'Turno 6', shortLabel: 'Qui Manhã',
        badge: 'Qui • 04/06 • Manhã (8h30–12h30)', badgeBg: '#fff3e0', badgeColor: '#e65100',
        courses: [
            {
                id: 'c6-1', name: 'Licitações e Contratos', theme: 'theme-amber', tag: 'Licitações e Contratos',
                title: 'Aplicação prática da Lei de Licitações na fase preparatória e na gestão e fiscalização de contratos', subtitle: 'Plano de Compras Anual (PCA)',
                instructor: 'Rosana Gama', instrRole: 'Auditora de Controle Externo (TCMPA)', instrInitials: 'RG', instrTheme: 'theme-amber',
                desc: 'Capacitar os participantes em relação à elaboração do Plano de Compras Anual (PCA).',
                publico: 'Servidores públicos que atuam na área de planejamento, administração, compras, licitações, contratos.',
                duracao: '16h', vagas: 50, ctaColor: '#8B1A2B'
            },
            {
                id: 'c6-2', name: 'Políticas Públicas', theme: 'theme-teal', tag: 'Políticas Públicas',
                title: 'Captação de Recursos na Saúde: do Planejamento à Execução sem Apontamentos do Controle Externo', subtitle: 'Planejamento em saúde',
                instructor: 'Silvia Miralha de Araújo', instrRole: 'Auditora de Controle Externo (TCMPA)', instrInitials: 'SM', instrTheme: 'theme-teal',
                desc: 'Fortalecer a capacidade dos jurisdicionados para identificar, planejar, captar e executar recursos na área da saúde.',
                publico: 'Prefeitos(as), Secretários(as) Municipais de Saúde, coordenadores, técnicos das áreas de planejamento.',
                duracao: '4h', vagas: 50, ctaColor: '#10517f'
            },
            {
                id: 'c6-3', name: 'Gestão e Finanças', theme: 'theme-rose', tag: 'Gestão e Finanças',
                title: 'Regularidade Funcional do Servidor Público: ingresso, acúmulo de vínculos e concessão de diárias', subtitle: 'Ingresso no serviço público',
                instructor: 'Maria Isis da Silva Campos', instrRole: 'Técnica de Controle Externo (TCMPA)', instrInitials: 'MI', instrTheme: 'theme-rose',
                desc: 'Prover aos órgãos e entidades sob jurisdição do TCMPA informações centrais sobre regularidade do servidor público.',
                publico: 'Gestores municipais; Servidores do controle interno; Servidores atuantes na gestão de pessoas.',
                duracao: '4h', vagas: 50, ctaColor: '#CC3366'
            }
        ]
    },
    {
        id: 7, label: 'Turno 7', shortLabel: 'Qui Tarde',
        badge: 'Qui • 04/06 • Tarde (14h–18h)', badgeBg: '#e0f2fe', badgeColor: '#0369a1',
        courses: [
            {
                id: 'c7-1', name: 'Políticas Públicas', theme: 'theme-blue', tag: 'Políticas Públicas',
                title: 'Recursos da educação da teoria à prática: Salário-Educação, PNAE, PNATE e PDDE', subtitle: 'Salário-Educação e PNAE',
                instructor: 'Everaldo Lino Alves', instrRole: 'Auditor de Controle Externo (TCMPA)', instrInitials: 'EL', instrTheme: 'theme-blue',
                desc: 'Fortalecer a capacidade técnica dos gestores e servidores públicos para planejar, executar, controlar e prestar contas dos recursos do Salário-Educação, PNAE, PNATE e PDDE.',
                publico: 'Secretários Municipais de Educação, equipes técnicas, gestores, membros de conselhos escolares, contadores.',
                duracao: '4h', vagas: 50, ctaColor: '#004a80'
            },
            {
                id: 'c7-2', name: 'Licitações e Contratos', theme: 'theme-emerald', tag: 'Licitações e Contratos',
                title: 'Aplicação prática da Lei de Licitações na fase preparatória e na gestão e fiscalização de contratos', subtitle: 'Plano de Compras Anual (PCA)',
                instructor: 'Rosana Gama', instrRole: 'Auditora de Controle Externo (TCMPA)', instrInitials: 'RG', instrTheme: 'theme-emerald',
                desc: 'Capacitar os participantes em relação à elaboração do Plano de Compras Anual (PCA).',
                publico: 'Servidores públicos que atuam na área de planejamento, compras, licitações, contratos.',
                duracao: '4h', vagas: 50, ctaColor: '#00a86b'
            },
            {
                id: 'c7-3', name: 'Políticas Públicas', theme: 'theme-violet', tag: 'Políticas Públicas',
                title: 'Mudanças Climáticas na Prática Municipal: como adaptar, mitigar e agir', subtitle: 'Mitigação e adaptação climática',
                instructor: 'Iranildo Ferreira Pereira', instrRole: 'Auditor de Controle Externo (TCMPA)', instrInitials: 'IF', instrTheme: 'theme-violet',
                desc: 'Capacitar servidores municipais para compreender e aplicar conceitos e estratégias de mitigação e adaptação às mudanças climáticas na gestão local.',
                publico: 'Servidores públicos municipais de áreas estratégicas.',
                duracao: '4h', vagas: 50, ctaColor: '#9b51e0'
            }
        ]
    },
    {
        id: 8, label: 'Turno 8', shortLabel: 'Sex Manhã',
        badge: 'Sex • 05/06 • Manhã (8h30–12h30)', badgeBg: '#fef3c7', badgeColor: '#92400e',
        courses: [
            {
                id: 'c8-1', name: 'Licitações e Contratos', theme: 'theme-amber', tag: 'Licitações e Contratos',
                title: 'Aplicação prática da Lei de Licitações na fase preparatória e na gestão e fiscalização de contratos', subtitle: 'Plano de Compras Anual (PCA)',
                instructor: 'Rosana Gama', instrRole: 'Auditora de Controle Externo (TCMPA)', instrInitials: 'RG', instrTheme: 'theme-amber',
                desc: 'Capacitar os participantes em relação à elaboração do Plano de Compras Anual (PCA).',
                publico: 'Servidores públicos que atuam na área de planejamento, compras, licitações, contratos.',
                duracao: '4h', vagas: 50, ctaColor: '#8B1A2B'
            }
        ]
    }
];

const MUNICIPIOS_PA = [
    "Abaetetuba","Abel Figueiredo","Acará","Afuá","Água Azul do Norte","Alenquer","Almeirim",
    "Altamira","Anajás","Ananindeua","Anapu","Augusto Corrêa","Aurora do Pará","Aveiro",
    "Bagre","Baião","Bannach","Barcarena","Belém","Belterra","Benevides","Bom Jesus do Tocantins",
    "Bonito","Bragança","Brasil Novo","Brejo Grande do Araguaia","Breu Branco","Breves",
    "Bujaru","Cachoeira do Arari","Cachoeira do Piriá","Cametá","Canaã dos Carajás",
    "Capanema","Capitão Poço","Castanhal","Chaves","Colares","Conceição do Araguaia",
    "Concórdia do Pará","Cumaru do Norte","Curionópolis","Curralinho","Curuá","Curuçá",
    "Dom Eliseu","Eldorado dos Carajás","Faro","Floresta do Araguaia","Garrafão do Norte",
    "Goianésia do Pará","Gurupá","Igarapé-Açu","Igarapé-Miri","Inhangapi","Ipixuna do Pará",
    "Irituia","Itaituba","Itupiranga","Jacareacanga","Jacundá","Juruti","Limoeiro do Ajuru",
    "Mãe do Rio","Magalhães Barata","Marabá","Maracanã","Marapanim","Marituba",
    "Medicilândia","Melgaço","Mocajuba","Moju","Mojuí dos Campos","Monte Alegre",
    "Muaná","Nova Esperança do Piriá","Nova Ipixuna","Nova Timboteua","Novo Progresso",
    "Novo Repartimento","Óbidos","Oeiras do Pará","Oriximiná","Ourém","Ourilândia do Norte",
    "Pacajá","Palestina do Pará","Paragominas","Parauapebas","Pau D'Arco","Peixe-Boi",
    "Piçarra","Placas","Ponta de Pedras","Portel","Porto de Moz","Prainha",
    "Primavera","Quatipuru","Redenção","Rio Maria","Rondon do Pará","Rurópolis",
    "Salinópolis","Salvaterra","Santa Bárbara do Pará","Santa Cruz do Arari",
    "Santa Izabel do Pará","Santa Luzia do Pará","Santa Maria das Barreiras",
    "Santa Maria do Pará","Santana do Araguaia","Santarém","Santarém Novo",
    "Santo Antônio do Tauá","São Caetano de Odivelas","São Domingos do Araguaia",
    "São Domingos do Capim","São Félix do Xingu","São Francisco do Pará",
    "São Geraldo do Araguaia","São João da Ponta","São João de Pirabas",
    "São João do Araguaia","São Miguel do Guamá","São Sebastião da Boa Vista",
    "Sapucaia","Senador José Porfírio","Soure","Tailândia","Terra Alta","Terra Santa",
    "Tomé-Açu","Tracuateua","Trairão","Tucumã","Tucuruí","Ulianópolis","Uruará",
    "Vigia","Viseu","Vitória do Xingu","Xinguara"
];

/* ═══════════════════════════════════════════
   GOOGLE FORMS — INTEGRAÇÃO AUTOMÁTICA
   Form ID: 1FAIpQLSfHwVX-53NsItdGpcD-hyh7OVfPJUy3vn6skiPUpdY44pGA2g
═══════════════════════════════════════════ */
const GFORMS = {
    url: 'https://docs.google.com/forms/d/e/1FAIpQLSfHwVX-53NsItdGpcD-hyh7OVfPJUy3vn6skiPUpdY44pGA2g/formResponse',
    f: {
        nome:      'entry.137986107',
        email:     'entry.387358485',
        cpf:       'entry.170998325',
        telefone:  'entry.1003090881',
        municipio: 'entry.1275313173',
        orgao:     'entry.1044411995',
        cargo:     'entry.2131353385',
        turno1:    'entry.2119241331',
        turno2:    'entry.1270592413',
        turno3:    'entry.632286599',
        turno4:    'entry.1768044873',
        turno5:    'entry.1531634535',
        turno6:    'entry.1111358019',
        turno7:    'entry.1252968113',
        turno8:    'entry.1480293428',
        turno9:    'entry.1263760165',
        turno10:   'entry.1211875394',
        total:     'entry.419920169'
    }
};

function enviarGoogleForms() {
    const fd = new URLSearchParams();
    const F = GFORMS.f;

    fd.append(F.nome, gv('f-nome'));
    fd.append(F.email, gv('f-email'));
    fd.append(F.cpf, gv('f-cpf'));
    fd.append(F.telefone, gv('f-tel'));
    fd.append(F.municipio, gv('f-mun'));
    fd.append(F.orgao, gv('f-orgao'));
    fd.append(F.cargo, gv('f-cargo'));

    let totalCursos = 0;
    TURNOS.forEach(t => {
        const fieldKey = F['turno' + t.id];
        if (!fieldKey) return; // campo não existe no Google Forms
        const sel = selections[t.id];
        if (sel) {
            fd.append(fieldKey, sel.curso + ' (' + sel.instrutor + ')');
            totalCursos++;
        } else {
            fd.append(fieldKey, '\u2014');
        }
    });
    fd.append(F.total, String(totalCursos));

    return fetch(GFORMS.url, {
        method: 'POST',
        mode: 'no-cors',
        headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
        body: fd.toString()
    });
}

/* ═══════════════════════════════════════════
   SVG ICONS (Lucide-style, stroke-based)
═══════════════════════════════════════════ */
const ICO = {
    user: '<span class="icon"><svg viewBox="0 0 24 24"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></svg></span>',
    check: '<span class="icon"><svg viewBox="0 0 24 24"><polyline points="20 6 9 17 4 12"/></svg></span>',
    checkCircle: '<span class="icon" style="font-size:36px"><svg viewBox="0 0 24 24"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/><polyline points="22 4 12 14.01 9 11.01"/></svg></span>',
    bookOpen: '<span class="icon"><svg viewBox="0 0 24 24"><path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"/><path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"/></svg></span>',
    users: '<span class="icon"><svg viewBox="0 0 24 24"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M23 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></svg></span>',
    clock: '<span class="icon"><svg viewBox="0 0 24 24"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg></span>',
    clipboard: '<span class="icon"><svg viewBox="0 0 24 24"><path d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"/><rect x="8" y="2" width="8" height="4" rx="1" ry="1"/></svg></span>',
    pin: '<span class="icon"><svg viewBox="0 0 24 24"><path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"/><circle cx="12" cy="10" r="3"/></svg></span>',
    arrowRight: '<span class="icon"><svg viewBox="0 0 24 24"><line x1="5" y1="12" x2="19" y2="12"/><polyline points="12 5 19 12 12 19"/></svg></span>',
    pencil: '<span class="icon"><svg viewBox="0 0 24 24"><path d="M17 3a2.828 2.828 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5L17 3z"/></svg></span>',
};

/* ═══════════════════════════════════════════
   STATE — Dinâmico, calculado a partir de TURNOS
   Step 1 = Dados Pessoais
   Steps 2..N+1 = Turnos 1..N
   Step N+2 = Confirmação
═══════════════════════════════════════════ */
let currentStep = 1;
let selections = {};
let STEPS = [];
let progressLabels = [];
let successShown = false;
const DEFAULT_TURNOS = JSON.parse(JSON.stringify(TURNOS));

function getConfirmStep() { return TURNOS.length + 2; }
function getLastTurnoStep() { return TURNOS.length + 1; }
function isTurnoStep(stepId) { return stepId >= 2 && stepId <= TURNOS.length + 1; }

function initState() {
    selections = {};
    TURNOS.forEach(t => { selections[t.id] = null; });
    STEPS = [{ id: 1, label: ICO.user }];
    TURNOS.forEach((t, i) => { STEPS.push({ id: i + 2, label: 'T' + (i + 1) }); });
    STEPS.push({ id: TURNOS.length + 2, label: ICO.check });
    progressLabels = ['Dados'];
    TURNOS.forEach(t => progressLabels.push(t.shortLabel));
    progressLabels.push('Confirmar');
}

/* ═══════════════════════════════════════════
   TOAST
═══════════════════════════════════════════ */
let toastTimer = null;
function showToast(msg, type = '') {
    const t = document.getElementById('toast');
    t.textContent = msg;
    t.className = 'toast show ' + type;
    clearTimeout(toastTimer);
    toastTimer = setTimeout(() => t.className = 'toast', 2500);
}

/* ═══════════════════════════════════════════
   BUILD PROGRESS BAR
═══════════════════════════════════════════ */
function buildProgress() {
    const c = document.getElementById('progressInner');
    let html = '';
    STEPS.forEach((s, i) => {
        html += `<div class="prog-step ${i === 0 ? 'active' : ''}" data-step="${s.id}" onclick="goToStep(${s.id})">
            <div class="prog-circle" id="pc-${s.id}" data-label="${typeof s.label === 'string' && !s.label.includes('<') ? s.label : ''}">${s.label}</div>
            <div class="prog-label">${progressLabels[i] || ''}</div>
        </div>`;
        if (i < STEPS.length - 1) html += `<div class="prog-line" id="pl-${s.id}"></div>`;
    });
    c.innerHTML = html;
}

/* ═══════════════════════════════════════════
   BUILD COURSE PANELS
═══════════════════════════════════════════ */
function buildPanels() {
    const container = document.getElementById('panelsContainer');
    let html = '';

    // Step 1 — Form (FIRST!)
    html += buildFormPanel();

    // Turno panels — dynamic step numbers
    TURNOS.forEach((turno, ti) => {
        const stepNum = ti + 2;
        const isLast = ti === TURNOS.length - 1;
        html += `<div class="step-panel" id="step-${stepNum}">
            <div class="turno-info">
                <div class="turno-badge" style="background:${turno.badgeBg};color:${turno.badgeColor}">${turno.badge}</div>
            </div>
            <div class="tabs-label">Escolha uma das opções abaixo</div>
            <div class="course-tabs" id="tabs-${turno.id}">
                ${turno.courses.map((c, idx) => `<button class="course-tab ${idx === 0 ? 'active' : ''}" data-turno="${turno.id}" data-idx="${idx}" onclick="switchTab(${turno.id}, ${idx})"><div class="tab-radio"></div><div class="tab-color ${c.theme}"></div><div class="tab-content"><div class="tab-title">${c.title}</div><div class="tab-subtitle">${c.tag} · ${c.instructor}</div></div></button>`).join('')}
            </div>
            <div class="tab-arrow" id="arrow-${turno.id}"></div>
            <div class="cards-grid" id="tabgrid-${turno.id}">
                ${turno.courses.map((c, idx) => buildCard(turno.id, c, idx === 0)).join('')}
            </div>
            <div class="nav-stack">
                <button class="btn ${isLast ? 'btn-success' : 'btn-primary'}" onclick="goToStep(${isLast ? getConfirmStep() : stepNum + 1})">${isLast ? 'Revisar Inscrição →' : 'Próximo →'}</button>
                <button class="btn btn-ghost" onclick="goToStep(${stepNum - 1})">← Voltar</button>
                ${!isLast ? `<button class="btn btn-ghost" onclick="goToStep(${stepNum + 1})">Pular Turno →</button>` : ''}
            </div>
        </div>`;
    });

    // Step 7 — Confirm
    html += buildConfirmPanel();
    // Success
    html += buildSuccessPanel();

    container.innerHTML = html;
}

function buildCard(turnoId, c, visible) {
    return `<div class="course-card ${visible ? 'tab-visible' : ''}" data-course-id="${c.id}" onclick="toggleCourse(${turnoId},'${c.id}','${c.name.replace(/'/g,"\\'")}','${c.instructor.replace(/'/g,"\\'")}','${c.duracao}')">
        <div class="card-head ${c.theme}">
            <div class="card-check"><svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M5 13l4 4L19 7"/></svg></div>
            <div class="card-tag">${c.tag}</div>
            <h3>${c.title}</h3>
            <p>${c.subtitle}</p>
        </div>
        <div class="card-body">
            <div class="instructor">
                <div class="instructor-avatar ${c.instrTheme}">${c.instrInitials}</div>
                <div>
                    <div class="instructor-name">${c.instructor}</div>
                    <div class="instructor-role">${c.instrRole}</div>
                </div>
            </div>
            <div class="card-section-title">${ICO.bookOpen} Sobre o Curso</div>
            <div class="card-desc">${c.desc}</div>
            <div class="card-section-title">${ICO.users} Público Alvo</div>
            <div class="card-desc">${c.publico}</div>
            <div class="card-footer">
                <div class="card-meta"><span>${ICO.clock} ${c.duracao}</span><span>${ICO.users} ${c.vagas} vagas</span></div>
                <div class="card-cta" style="color:${c.ctaColor}">Escolher este curso</div>
            </div>
        </div>
    </div>`;
}

function buildFormPanel() {
    const munOptions = MUNICIPIOS_PA.map(m => `<option value="${m}">${m}</option>`).join('');
    return `<div class="step-panel active" id="step-1">
        <div class="form-wrapper">
            <div class="turno-header">
                <div style="width:56px;height:56px;background:var(--slate-100);border-radius:16px;display:flex;align-items:center;justify-content:center;margin:0 auto 12px;font-size:24px;color:var(--slate-500)">${ICO.user}</div>
                <h2 class="turno-title">Seus Dados</h2>
                <p class="turno-sub">Preencha seus dados para iniciar a seleção de cursos</p>
            </div>
            <div class="form-card">
                <div class="form-group">
                    <label class="form-label">Nome Completo <span class="req">*</span></label>
                    <input type="text" id="f-nome" class="form-input" placeholder="Seu nome completo" autocomplete="name">
                    <div class="form-input-hint">Informe seu nome completo</div>
                </div>
                <div class="form-group">
                    <label class="form-label">E-mail <span class="req">*</span></label>
                    <input type="email" id="f-email" class="form-input" placeholder="seu@email.com" autocomplete="email">
                    <div class="form-input-hint">Informe um e-mail válido</div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">CPF <span class="req">*</span></label>
                        <input type="text" id="f-cpf" class="form-input" placeholder="000.000.000-00" maxlength="14" inputmode="numeric">
                        <div class="form-input-hint">CPF inválido</div>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Telefone <span class="req">*</span></label>
                        <input type="tel" id="f-tel" class="form-input" placeholder="(00) 00000-0000" maxlength="15" inputmode="numeric">
                        <div class="form-input-hint">Informe seu telefone</div>
                    </div>
                </div>
                <div class="form-group">
                    <label class="form-label">Município <span class="req">*</span></label>
                    <select id="f-mun" class="form-input">
                        <option value="">Selecione seu município...</option>
                        ${munOptions}
                    </select>
                    <div class="form-input-hint">Selecione o município</div>
                </div>
                <div class="form-group">
                    <label class="form-label">Órgão <span class="req">*</span></label>
                    <select id="f-orgao" class="form-input">
                        <option value="">Selecione...</option>
                        <option>Prefeitura Municipal</option>
                        <option>Câmara Municipal</option>
                        <option>Autarquia</option>
                        <option>Fundação</option>
                        <option>Empresa Pública</option>
                        <option>Sociedade de Economia Mista</option>
                        <option>Consórcio Público</option>
                        <option>Outro</option>
                    </select>
                    <div class="form-input-hint">Selecione o órgão</div>
                </div>
                <div class="form-group">
                    <label class="form-label">Cargo / Função <span class="req">*</span></label>
                    <input type="text" id="f-cargo" class="form-input" placeholder="Ex: Contador, Controlador Interno..." autocomplete="organization-title">
                    <div class="form-input-hint">Informe seu cargo</div>
                </div>
            </div>
            <div class="nav-row" style="margin-top:24px">
                <div></div>
                <button class="btn btn-primary" onclick="goToStep(2)">Escolher Cursos →</button>
            </div>
        </div>
    </div>`;
}

function buildConfirmPanel() {
    return `<div class="step-panel" id="step-${getConfirmStep()}">
        <div class="confirm-wrapper">
            <div class="turno-header">
                <div style="width:56px;height:56px;background:#fce4ea;border-radius:16px;display:flex;align-items:center;justify-content:center;margin:0 auto 12px;font-size:24px;color:#8B1A2B">${ICO.clipboard}</div>
                <h2 class="turno-title">Confirmar Inscrição</h2>
            </div>
            <div class="confirm-card">
                <div class="confirm-section-header">
                    <div class="confirm-section-title">${ICO.bookOpen} Seus Cursos</div>
                    <button class="btn-edit-section" onclick="toggleEditCourses()">${ICO.pencil} <span id="btnEditCoursesLabel">Alterar</span></button>
                </div>
                <div id="confirmCourses"></div>
                <hr style="border:none;border-top:1px solid var(--slate-100);margin:16px 0">
                <div class="confirm-section-header">
                    <div class="confirm-section-title">${ICO.user} Seus Dados</div>
                    <button class="btn-edit-section" onclick="toggleEditData()">${ICO.pencil} <span id="btnEditDataLabel">Editar</span></button>
                </div>
                <div id="confirmData"></div>
            </div>
            <label class="terms-label">
                <input type="checkbox" id="f-termos">
                <span>Declaro que as informações prestadas são verdadeiras e me comprometo a participar dos cursos selecionados, ciente de que a ausência sem justificativa poderá impactar futuras inscrições.</span>
            </label>
            <div class="nav-row">
                <button class="btn btn-ghost" onclick="goToStep(${getLastTurnoStep()})">← Voltar</button>
                <button class="btn btn-success" id="btn-finalizar" onclick="finalizar()" style="font-size:15px;padding:12px 28px">${ICO.check} Confirmar Inscrição</button>
            </div>
        </div>
    </div>`;
}

function buildSuccessPanel() {
    return `<div class="step-panel" id="step-success">
        <div class="success-wrapper">
            <div class="success-icon" style="color:#00a86b">${ICO.checkCircle}</div>
            <h2 class="success-title">Inscrição Confirmada!</h2>
            <p class="success-sub">Enviamos os detalhes para o seu e-mail.</p>
            <div class="success-box">
                <h4>${ICO.pin} Próximos Passos</h4>
                <ul class="success-steps">
                    <li>Verifique seu e-mail (inclusive spam)</li>
                    <li>Adicione as datas à sua agenda</li>
                    <li>O link de acesso será enviado 1 dia antes</li>
                </ul>
            </div>
            <div class="success-box">
                <h4>${ICO.bookOpen} Cursos Selecionados</h4>
                <div id="successCourses"></div>
            </div>
            <button class="btn btn-dark" onclick="location.reload()" style="margin-top:20px">Nova Inscrição</button>
        </div>
    </div>`;
}

/* ═══════════════════════════════════════════
   NAVIGATION
═══════════════════════════════════════════ */
function goToStep(step) {
    // Step 1 = Dados, validate on leaving step 1 to step 2
    if (step === 2 && currentStep === 1) {
        if (!validateForm()) return;
    }

    // Validação confirm step → precisa de pelo menos 1 curso + form válido
    if (step === getConfirmStep()) {
        if (getCount() === 0) { showToast('Selecione pelo menos 1 curso!', 'warn'); return; }
        if (!validateForm()) return;
        fillConfirmation();
    }

    currentStep = step;
    document.querySelectorAll('.step-panel').forEach(p => p.classList.remove('active'));
    const panel = document.getElementById(step === 'success' ? 'step-success' : `step-${step}`);
    if (panel) panel.classList.add('active');

    updateProgress(step);
    if (isTurnoStep(step)) restoreSelection(step - 1);

    // Hide counter on form(step1)/confirm/success
    document.getElementById('floatCounter').style.display = (step === 1 || step >= getConfirmStep() || step === 'success') ? 'none' : '';

    // Steps 2-7: hide header, show only progress bar + content
    const hideHeader = step >= 2 && step !== 'success';
    document.body.classList.toggle('header-hidden', hideHeader);

    if (hideHeader) {
        // Scroll so progress bar sits at very top of viewport
        const benefits = document.querySelector('.benefits');
        if (benefits) {
            const target = benefits.offsetTop + benefits.offsetHeight;
            window.scrollTo({ top: target, behavior: 'smooth' });
            return;
        }
    }
    window.scrollTo({ top: 0, behavior: 'smooth' });
}

function updateProgress(step) {
    STEPS.forEach((s, i) => {
        const circle = document.getElementById(`pc-${s.id}`);
        const line = document.getElementById(`pl-${s.id}`);
        const parent = circle.parentElement;
        parent.className = 'prog-step';
        parent.setAttribute('onclick', `goToStep(${s.id})`);

        if (s.id == step) {
            parent.classList.add('active');
        } else if (s.id < step) {
            const turno = isTurnoStep(s.id);
            if (turno && !selections[s.id - 1]) {
                parent.classList.add('skipped');
                circle.innerHTML = '−';
            } else {
                parent.classList.add('completed');
                if (turno) circle.innerHTML = ICO.check;
            }
        } else {
            if (isTurnoStep(s.id)) circle.innerHTML = STEPS[i].label;
        }

        if (line) line.className = 'prog-line' + (s.id < step ? ' done' : '');
    });
}

/* ═══════════════════════════════════════════
   COURSE SELECTION
═══════════════════════════════════════════ */
function toggleCourse(turnoId, courseId, name, instructor, duracao) {
    const panel = document.getElementById(`step-${turnoId + 1}`);
    const cards = panel.querySelectorAll('.course-card');
    const clickedCard = panel.querySelector(`[data-course-id="${courseId}"]`);
    const wasSelected = clickedCard.classList.contains('selected');

    cards.forEach(c => c.classList.remove('selected'));

    if (wasSelected) {
        selections[turnoId] = null;
    } else {
        clickedCard.classList.add('selected');
        selections[turnoId] = { curso: name, instrutor: instructor, duracao, courseId };
    }
    updateCounter();
}

function restoreSelection(turnoId) {
    const panel = document.getElementById(`step-${turnoId + 1}`);
    if (!panel) return;
    panel.querySelectorAll('.course-card').forEach(c => {
        c.classList.remove('selected');
        if (selections[turnoId] && c.dataset.courseId === selections[turnoId].courseId) {
            c.classList.add('selected');
        }
    });
}

function getCount() { return Object.values(selections).filter(Boolean).length; }

function updateCounter() {
    const n = getCount();
    document.getElementById('counterNum').textContent = n;
    const st = document.getElementById('counterStatus');
    if (n === 0) { st.className = 'float-counter-status warn'; st.textContent = 'Mín: 1 curso'; }
    else { st.className = 'float-counter-status ok'; st.textContent = `${n} curso${n > 1 ? 's' : ''} ✓`; }
}

/* ═══════════════════════════════════════════
   FORM & VALIDATION
═══════════════════════════════════════════ */
function validateForm() {
    const fields = [
        { id: 'f-nome', check: v => v.length >= 3 },
        { id: 'f-email', check: v => /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(v) },
        { id: 'f-cpf', check: v => validarCPF(v) },
        { id: 'f-tel', check: v => v.replace(/\D/g,'').length >= 10 },
        { id: 'f-mun', check: v => v.length > 0 },
        { id: 'f-orgao', check: v => v.length > 0 },
        { id: 'f-cargo', check: v => v.length >= 2 },
    ];
    let ok = true;
    fields.forEach(f => {
        const el = document.getElementById(f.id);
        const val = el.value.trim();
        if (!f.check(val)) { el.classList.add('error'); ok = false; } else { el.classList.remove('error'); }
    });
    if (!ok) {
        showToast('Preencha todos os campos corretamente!', 'error');
        goToStep(1);
    }
    return ok;
}

function validarCPF(cpf) {
    cpf = cpf.replace(/\D/g, '');
    if (cpf.length !== 11 || /^(\d)\1{10}$/.test(cpf)) return false;
    let soma = 0;
    for (let i = 0; i < 9; i++) soma += parseInt(cpf[i]) * (10 - i);
    let resto = (soma * 10) % 11;
    if (resto === 10) resto = 0;
    if (resto !== parseInt(cpf[9])) return false;
    soma = 0;
    for (let i = 0; i < 10; i++) soma += parseInt(cpf[i]) * (11 - i);
    resto = (soma * 10) % 11;
    if (resto === 10) resto = 0;
    return resto === parseInt(cpf[10]);
}

function fillFormSummary() {
    // Not needed — form is now step 1
}

function fillConfirmation() {
    // Courses — each row has a dropdown to change course inline
    let ch = '';
    TURNOS.forEach(t => {
        if (selections[t.id]) {
            const opts = t.courses.map(c =>
                `<option value="${c.id}" ${c.id === selections[t.id].courseId ? 'selected' : ''}>${c.name}</option>`
            ).join('');
            ch += `<div class="confirm-course-row" data-turno-id="${t.id}">
                <span class="turno">${t.shortLabel}</span>
                <span class="name">${selections[t.id].curso}</span>
                <select class="course-select" onchange="changeCourseInline(${t.id}, this.value)">${opts}</select>
                <button class="btn-change-course" onclick="startPickCourse(this)">Alterar</button>
            </div>`;
        }
    });
    document.getElementById('confirmCourses').innerHTML = ch;

    // Data — each row has an inline input for editing
    const ORGAOS = ['Prefeitura Municipal','Câmara Municipal','Autarquia','Fundação','Empresa Pública','Sociedade de Economia Mista','Consórcio Público','Outro'];
    const fields = [
        { label: 'Nome', id: 'f-nome', type: 'text' },
        { label: 'E-mail', id: 'f-email', type: 'email' },
        { label: 'CPF', id: 'f-cpf', type: 'text' },
        { label: 'Telefone', id: 'f-tel', type: 'tel' },
        { label: 'Município', id: 'f-mun', type: 'select', options: MUNICIPIOS_PA },
        { label: 'Órgão', id: 'f-orgao', type: 'select', options: ORGAOS },
        { label: 'Cargo', id: 'f-cargo', type: 'text' }
    ];
    document.getElementById('confirmData').innerHTML = fields.map(f => {
        const val = gv(f.id);
        let inputHtml;
        if (f.type === 'select') {
            const opts = f.options.map(o => `<option value="${o}" ${o === val ? 'selected' : ''}>${o}</option>`).join('');
            inputHtml = `<select class="edit-input" data-field="${f.id}">${opts}</select>`;
        } else {
            inputHtml = `<input class="edit-input" type="${f.type}" value="${val}" data-field="${f.id}">`;
        }
        return `<div class="confirm-data-row"><span class="label">${f.label}:</span><span class="value">${val}</span>${inputHtml}</div>`;
    }).join('');

    // Reset edit states
    _editingData = false;
    _editingCourses = false;
    const dl = document.getElementById('btnEditDataLabel');
    const cl = document.getElementById('btnEditCoursesLabel');
    if (dl) dl.textContent = 'Editar';
    if (cl) cl.textContent = 'Alterar';
}

let _editingData = false;
let _editingCourses = false;

function toggleEditData() {
    _editingData = !_editingData;
    const container = document.getElementById('confirmData');
    const label = document.getElementById('btnEditDataLabel');
    if (_editingData) {
        label.textContent = 'Salvar';
        container.querySelectorAll('.confirm-data-row').forEach(r => r.classList.add('editing'));
    } else {
        // Save values back to the original form inputs
        container.querySelectorAll('.edit-input').forEach(inp => {
            const srcId = inp.dataset.field;
            const srcEl = document.getElementById(srcId);
            if (srcEl) srcEl.value = inp.value;
        });
        // Re-render to show updated values
        label.textContent = 'Editar';
        container.querySelectorAll('.confirm-data-row').forEach(r => {
            r.classList.remove('editing');
            const inp = r.querySelector('.edit-input');
            if (inp) r.querySelector('.value').textContent = inp.value;
        });
        showToast('Dados atualizados!', 'success');
    }
}

function toggleEditCourses() {
    _editingCourses = !_editingCourses;
    const container = document.getElementById('confirmCourses');
    const label = document.getElementById('btnEditCoursesLabel');
    if (_editingCourses) {
        label.textContent = 'Pronto';
        container.classList.add('editing-courses');
    } else {
        label.textContent = 'Alterar';
        container.classList.remove('editing-courses');
        // Close any open pickers
        container.querySelectorAll('.confirm-course-row.picking').forEach(r => r.classList.remove('picking'));
    }
}

function startPickCourse(btn) {
    const row = btn.closest('.confirm-course-row');
    row.classList.add('picking');
    const sel = row.querySelector('.course-select');
    sel.focus();
    sel.addEventListener('blur', () => { row.classList.remove('picking'); }, { once: true });
}

function changeCourseInline(turnoId, courseId) {
    const turno = TURNOS.find(t => t.id === turnoId);
    const course = turno.courses.find(c => c.id === courseId);
    if (!course) return;
    // Update selection
    selections[turnoId] = { curso: course.name, instrutor: course.instructor, duracao: course.duracao, courseId: course.id };
    // Update the card selection visuals in the turno step
    restoreSelection(turnoId);
    // Update the row name text
    const row = document.querySelector(`.confirm-course-row[data-turno-id="${turnoId}"]`);
    if (row) {
        row.querySelector('.name').textContent = course.name;
        row.classList.remove('picking');
    }
    updateCounter();
    showToast(`Curso alterado: ${course.name}`, 'success');
}

function gv(id) { return document.getElementById(id).value.trim(); }

/* ═══════════════════════════════════════════
   FINALIZAR
═══════════════════════════════════════════ */
function finalizar() {
    if (!document.getElementById('f-termos').checked) {
        showToast('Aceite os termos para confirmar.', 'warn');
        return;
    }

    const btn = document.getElementById('btn-finalizar');
    const btnOriginal = btn.innerHTML;
    btn.disabled = true;
    btn.innerHTML = '<span class="spinner"></span> Enviando...';

    enviarGoogleForms()
        .then(() => {
            console.log('[Escola de Contas] Inscricao enviada ao Google Forms!');
            showSuccess();
        })
        .catch(err => {
            console.error('[Escola de Contas] Erro ao enviar:', err);
            // mode: 'no-cors' may throw but data still arrives — show success
            showSuccess();
        });

    // Timeout fallback (5s) in case fetch hangs
    setTimeout(() => {
        if (btn.disabled) showSuccess();
    }, 5000);
}

function showSuccess() {
    if (successShown) return;
    successShown = true;
    const btn = document.getElementById('btn-finalizar');
    btn.disabled = false;

    // Fill success panel
    let html = '';
    TURNOS.forEach(t => {
        if (selections[t.id]) {
            html += `<div class="confirm-course-row"><span class="turno">${t.shortLabel}</span><span class="name">${selections[t.id].curso}</span></div>`;
        }
    });
    document.getElementById('successCourses').innerHTML = html;

    goToStep('success');

    // Mark all steps completed
    STEPS.forEach(s => {
        const circle = document.getElementById(`pc-${s.id}`);
        if (circle) {
            circle.parentElement.className = 'prog-step completed';
            const line = document.getElementById(`pl-${s.id}`);
            if (line) line.className = 'prog-line done';
        }
    });

    // Confetti
    const colors = ['#00d084','#0693e3','#A52240','#CC3366','#9b51e0','#004a80'];
    for (let i = 0; i < 60; i++) {
        const c = document.createElement('div');
        c.className = 'confetti';
        c.style.left = Math.random() * 100 + 'vw';
        c.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
        c.style.animationDelay = (Math.random() * 2) + 's';
        c.style.borderRadius = Math.random() > .5 ? '50%' : '2px';
        c.style.width = (6 + Math.random() * 6) + 'px';
        c.style.height = (6 + Math.random() * 6) + 'px';
        document.body.appendChild(c);
        setTimeout(() => c.remove(), 6000);
    }
}

/* ═══════════════════════════════════════════
   INPUT MASKS
═══════════════════════════════════════════ */
/* ═══════════════════════════════════════════
   COUNTDOWN TIMER
═══════════════════════════════════════════ */
function initCountdown() {
    const target = new Date('2026-03-09T14:00:00-03:00'); // 09 de março 2026, 14h Bragança
    const el = document.getElementById('countdown');
    if (!el) return;

    function update() {
        const now = new Date();
        const diff = target - now;

        if (diff <= 0) {
            el.innerHTML = '<div class="countdown-expired">O evento já começou!</div>';
            return;
        }

        const days = Math.floor(diff / (1000 * 60 * 60 * 24));
        const hours = Math.floor((diff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
        const mins = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
        const secs = Math.floor((diff % (1000 * 60)) / 1000);

        el.innerHTML = `
            <div class="countdown-item"><div class="countdown-num">${String(days).padStart(2,'0')}</div><div class="countdown-label">Dias</div></div>
            <div class="countdown-sep">:</div>
            <div class="countdown-item"><div class="countdown-num">${String(hours).padStart(2,'0')}</div><div class="countdown-label">Horas</div></div>
            <div class="countdown-sep">:</div>
            <div class="countdown-item"><div class="countdown-num">${String(mins).padStart(2,'0')}</div><div class="countdown-label">Min</div></div>
            <div class="countdown-sep">:</div>
            <div class="countdown-item"><div class="countdown-num">${String(secs).padStart(2,'0')}</div><div class="countdown-label">Seg</div></div>
        `;
    }

    update();
    setInterval(update, 1000);
}

function bindInputMasks() {
    const cpf = document.getElementById('f-cpf');
    const tel = document.getElementById('f-tel');
    if (cpf) cpf.addEventListener('input', function() {
        let v = this.value.replace(/\D/g, '').slice(0, 11);
        v = v.replace(/(\d{3})(\d)/, '$1.$2').replace(/(\d{3})(\d)/, '$1.$2').replace(/(\d{3})(\d{1,2})$/, '$1-$2');
        this.value = v;
    });
    if (tel) tel.addEventListener('input', function() {
        let v = this.value.replace(/\D/g, '').slice(0, 11);
        v = v.replace(/^(\d{2})(\d)/g, '($1) $2').replace(/(\d{5})(\d)/, '$1-$2');
        this.value = v;
    });
    document.querySelectorAll('.form-input').forEach(el => {
        el.addEventListener('focus', () => el.classList.remove('error'));
    });
}

document.addEventListener('DOMContentLoaded', async () => {
    await loadTurnosFromRemote();
    initState();
    buildProgress();
    buildPanels();
    bindInputMasks();
    initCountdown();
    initAdmin();
});

/* ═══════════════════════════════════════════
   TAB SWITCHING (mobile only, desktop shows all)
═══════════════════════════════════════════ */
function switchTab(turnoId, idx) {
    const tabsEl = document.getElementById('tabs-' + turnoId);
    const gridEl = document.getElementById('tabgrid-' + turnoId);
    const arrowEl = document.getElementById('arrow-' + turnoId);
    if (!tabsEl || !gridEl) return;

    // Update tab buttons
    tabsEl.querySelectorAll('.course-tab').forEach((t, i) => {
        t.classList.toggle('active', i === idx);
    });

    // Move arrow under active tab
    if (arrowEl) {
        const tabs = tabsEl.querySelectorAll('.course-tab');
        const totalTabs = tabs.length;
        // Center of the active tab: (idx + 0.5) / totalTabs * 100%
        const pct = ((idx + 0.5) / totalTabs * 100);
        arrowEl.style.setProperty('--arrow-left', pct + '%');
    }

    // Show only selected card
    gridEl.querySelectorAll('.course-card').forEach((card, i) => {
        card.classList.toggle('tab-visible', i === idx);
    });
}

// After course selection, mark the tab with a dot
const origToggleCourse = toggleCourse;
toggleCourse = function(turnoId, courseId, name, instructor, duracao) {
    origToggleCourse(turnoId, courseId, name, instructor, duracao);
    // Update tab selected indicator
    const tabsEl = document.getElementById('tabs-' + turnoId);
    if (!tabsEl) return;
    const turno = TURNOS.find(t => t.id === turnoId);
    if (!turno) return;
    tabsEl.querySelectorAll('.course-tab').forEach((tab, i) => {
        const cId = turno.courses[i].id;
        tab.classList.toggle('tab-selected', selections[turnoId] && selections[turnoId].courseId === cId);
    });
};

/* ═══════════════════════════════════════════
   REBUILD UI (after importing new data)
═══════════════════════════════════════════ */
function rebuildUI() {
    currentStep = 1;
    successShown = false;
    initState();
    document.getElementById('counterMax').textContent = TURNOS.length;
    buildProgress();
    buildPanels();
    bindInputMasks();
    updateHeroStats();
    goToStep(1);
    updateCounter();
}

/* ═══════════════════════════════════════════
   REMOTE JSON — Carrega programacao.json e publica via GitHub API
═══════════════════════════════════════════ */
const GITHUB_REPO = 'beoaraujo/escola-de-contas-tcmpa';
const GITHUB_FILE = 'programacao.json';
const GH_TOKEN_KEY = 'vtabs_gh_token';

async function loadTurnosFromRemote() {
    try {
        const resp = await fetch('programacao.json?_t=' + Date.now());
        if (resp.ok) {
            const data = await resp.json();
            if (Array.isArray(data) && data.length > 0) {
                TURNOS = data;
                return true;
            }
        }
    } catch(e) { console.warn('Erro ao carregar programacao.json, usando dados padrão.', e); }
    return false;
}

function saveGhToken() {
    const t = document.getElementById('adminGhToken').value.trim();
    if (t) {
        localStorage.setItem(GH_TOKEN_KEY, t);
        showToast('Token salvo!', 'success');
    }
}

function getGhToken() {
    return localStorage.getItem(GH_TOKEN_KEY) || '';
}

async function publishToGitHub(jsonData) {
    const token = getGhToken();
    if (!token) throw new Error('Token GitHub não configurado. Cole seu token no campo acima.');
    // 1. Buscar SHA atual do arquivo
    const metaResp = await fetch('https://api.github.com/repos/' + GITHUB_REPO + '/contents/' + GITHUB_FILE, {
        headers: { 'Authorization': 'token ' + token }
    });
    let sha = '';
    if (metaResp.ok) { const meta = await metaResp.json(); sha = meta.sha; }
    // 2. Atualizar arquivo no GitHub
    const body = {
        message: 'Atualizar programação via painel admin',
        content: btoa(unescape(encodeURIComponent(jsonData))),
        branch: 'main'
    };
    if (sha) body.sha = sha;
    const putResp = await fetch('https://api.github.com/repos/' + GITHUB_REPO + '/contents/' + GITHUB_FILE, {
        method: 'PUT',
        headers: { 'Authorization': 'token ' + token, 'Content-Type': 'application/json' },
        body: JSON.stringify(body)
    });
    if (!putResp.ok) {
        const err = await putResp.json();
        throw new Error('GitHub: ' + (err.message || putResp.statusText));
    }
    return true;
}

/* ═══════════════════════════════════════════
   NORMALIZER — simplified/full JSON → TURNOS format
═══════════════════════════════════════════ */
const THEME_CYCLE = ['theme-blue','theme-emerald','theme-violet','theme-amber','theme-teal','theme-rose'];
const BADGE_PRESETS = [
    { bg:'#e0effa', color:'#004a80' }, { bg:'#fce4ea', color:'#8B1A2B' },
    { bg:'#fce4ee', color:'#991f4d' }, { bg:'#e8f5ec', color:'#006b44' },
    { bg:'#f3e8ff', color:'#7b3bb5' }, { bg:'#fff3e0', color:'#e65100' },
    { bg:'#e0f2fe', color:'#0369a1' }, { bg:'#fef3c7', color:'#92400e' },
    { bg:'#ede9fe', color:'#6d28d9' }, { bg:'#fce7f3', color:'#be185d' }
];
const CTA_MAP = { 'theme-blue':'#004a80','theme-emerald':'#00a86b','theme-violet':'#9b51e0','theme-amber':'#8B1A2B','theme-teal':'#10517f','theme-rose':'#CC3366' };

function getInitials(name) {
    return (name || 'AD').split(/\s+/).filter(w => w.length > 2 || (w[0] && w[0] === w[0].toUpperCase()))
        .map(w => w[0].toUpperCase()).slice(0,2).join('') || 'AD';
}

function normalizeTurnos(input) {
    let rawTurnos;
    if (Array.isArray(input)) {
        rawTurnos = input; // full format
    } else if (input && input.turnos && Array.isArray(input.turnos)) {
        rawTurnos = input.turnos; // simplified format
    } else {
        throw new Error('Formato não reconhecido. Use array de turnos ou { turnos: [...] }');
    }
    return rawTurnos.map((t, ti) => {
        const bp = BADGE_PRESETS[ti % BADGE_PRESETS.length];
        return {
            id: t.id || ti + 1,
            label: t.label || 'Turno ' + (ti + 1),
            shortLabel: t.shortLabel || t.label || 'Turno ' + (ti + 1),
            badge: t.badge || t.shortLabel || 'Turno ' + (ti + 1),
            badgeBg: t.badgeBg || bp.bg,
            badgeColor: t.badgeColor || bp.color,
            courses: (t.courses || []).map((c, ci) => {
                const theme = c.theme || THEME_CYCLE[(ti * 3 + ci) % THEME_CYCLE.length];
                return {
                    id: c.id || 'c' + (ti+1) + '-' + (ci+1),
                    name: c.name || c.titulo || 'Curso ' + (ci+1),
                    theme: theme,
                    tag: c.tag || '',
                    title: c.title || c.titulo || c.name || '',
                    subtitle: c.subtitle || c.subtitulo || '',
                    instructor: c.instructor || c.instrutor || 'A definir',
                    instrRole: c.instrRole || c.cargo_instrutor || '',
                    instrInitials: c.instrInitials || getInitials(c.instructor || c.instrutor || ''),
                    instrTheme: c.instrTheme || theme,
                    desc: c.desc || c.descricao || '',
                    publico: c.publico || '',
                    duracao: c.duracao || '4h',
                    vagas: parseInt(c.vagas) || 50,
                    ctaColor: c.ctaColor || CTA_MAP[theme] || '#004a80'
                };
            })
        };
    });
}

/* ═══════════════════════════════════════════
   CSV PARSER
═══════════════════════════════════════════ */
function parseCSVLine(line) {
    const r = []; let cur = '', inQ = false;
    for (let i = 0; i < line.length; i++) {
        const ch = line[i];
        if (inQ) {
            if (ch === '"' && line[i+1] === '"') { cur += '"'; i++; }
            else if (ch === '"') inQ = false;
            else cur += ch;
        } else {
            if (ch === '"') inQ = true;
            else if (ch === ',' || ch === ';') { r.push(cur); cur = ''; }
            else cur += ch;
        }
    }
    r.push(cur);
    return r;
}

function parseCSV(text) {
    const lines = text.split(/\r?\n/).filter(l => l.trim());
    if (lines.length < 2) throw new Error('CSV deve ter pelo menos cabeçalho + 1 linha de dados');
    const headers = parseCSVLine(lines[0]).map(h => h.trim().toLowerCase());
    const rows = lines.slice(1).map(l => {
        const vals = parseCSVLine(l);
        const obj = {};
        headers.forEach((h, i) => { obj[h] = (vals[i] || '').trim(); });
        return obj;
    });

    const turnoMap = new Map();
    rows.forEach(row => {
        const key = row.turno || row.turno_shortlabel || row.turno_label || 'Turno';
        if (!turnoMap.has(key)) {
            turnoMap.set(key, { shortLabel: key, badge: row.turno_badge || row.badge || key, courses: [] });
        }
        if (row.name || row.nome || row.titulo) {
            turnoMap.get(key).courses.push({
                name: row.name || row.nome || row.titulo || '',
                tag: row.tag || '',
                title: row.title || row.titulo || row.name || row.nome || '',
                subtitle: row.subtitle || row.subtitulo || '',
                instructor: row.instructor || row.instrutor || '',
                instrRole: row.instrrole || row.cargo_instrutor || row.cargo || '',
                desc: row.desc || row.descricao || '',
                publico: row.publico || '',
                duracao: row.duracao || '4h',
                vagas: row.vagas || '50'
            });
        }
    });

    return { turnos: Array.from(turnoMap.values()) };
}

/* ═══════════════════════════════════════════
   VALIDATION
═══════════════════════════════════════════ */
function validateTurnos(turnos) {
    const e = [];
    if (!Array.isArray(turnos) || turnos.length === 0) { e.push('Nenhum turno encontrado.'); return e; }
    if (turnos.length > 10) e.push('Máximo de 10 turnos.');
    turnos.forEach((t, ti) => {
        if (!t.courses || t.courses.length === 0) e.push('Turno ' + (ti+1) + ' sem cursos.');
        else if (t.courses.length > 6) e.push('Turno ' + (ti+1) + ': máximo 6 cursos.');
        else t.courses.forEach((c, ci) => {
            if (!c.name || !c.name.trim()) e.push('Turno ' + (ti+1) + ', Curso ' + (ci+1) + ': campo "name" obrigatório.');
        });
    });
    return e;
}

/* ═══════════════════════════════════════════
   ADMIN — Init, Upload, Export, Reset
═══════════════════════════════════════════ */
function initAdmin() {
    if (!new URLSearchParams(window.location.search).has('admin')) return;
    document.getElementById('adminPanel').classList.add('visible');
    // Carregar token salvo
    const savedToken = getGhToken();
    if (savedToken) {
        document.getElementById('adminGhToken').value = savedToken;
    }
    const dz = document.getElementById('adminDropZone');
    const fi = document.getElementById('adminFileInput');
    fi.addEventListener('change', e => { if (e.target.files.length) handleUploadedFile(e.target.files[0]); });
    dz.addEventListener('dragover', e => { e.preventDefault(); dz.classList.add('dragover'); });
    dz.addEventListener('dragleave', () => dz.classList.remove('dragover'));
    dz.addEventListener('drop', e => {
        e.preventDefault(); dz.classList.remove('dragover');
        if (e.dataTransfer.files.length) handleUploadedFile(e.dataTransfer.files[0]);
    });
}

function handleUploadedFile(file) {
    const st = document.getElementById('adminStatus');
    const ext = file.name.split('.').pop().toLowerCase();
    if (!['json','csv'].includes(ext)) { st.innerHTML = '<div class="admin-status error">Use arquivo .json ou .csv</div>'; return; }
    const reader = new FileReader();
    reader.onload = async (e) => {
        try {
            let parsed;
            if (ext === 'csv') parsed = parseCSV(e.target.result);
            else parsed = JSON.parse(e.target.result);
            const normalized = normalizeTurnos(parsed);
            const errors = validateTurnos(normalized);
            if (errors.length) { st.innerHTML = '<div class="admin-status error">' + errors.join('<br>') + '</div>'; return; }
            // Atualizar localmente primeiro
            TURNOS = normalized;
            rebuildUI();
            const total = TURNOS.reduce((s, t) => s + t.courses.length, 0);
            st.innerHTML = '<div class="admin-status success" style="text-align:center">Publicando no site... aguarde</div>';
            // Publicar no GitHub (Vercel faz deploy automático)
            try {
                await publishToGitHub(JSON.stringify(TURNOS, null, 2));
                st.innerHTML = '<div class="admin-status success">Publicado! ' + TURNOS.length + ' turnos, ' + total + ' cursos.<br><small>O site atualiza para todos em ~30 segundos.</small></div>';
                showToast('Publicado para todos!', 'success');
            } catch(ghErr) {
                st.innerHTML = '<div class="admin-status error">Atualizado localmente, mas não publicou:<br>' + ghErr.message + '</div>';
            }
        } catch(err) { st.innerHTML = '<div class="admin-status error">Erro: ' + err.message + '</div>'; }
    };
    reader.readAsText(file, 'UTF-8');
}

function exportCurrentJSON() {
    const blob = new Blob([JSON.stringify(TURNOS, null, 2)], { type: 'application/json' });
    const a = document.createElement('a'); a.href = URL.createObjectURL(blob);
    a.download = 'escola-turnos.json'; a.click(); URL.revokeObjectURL(a.href);
    showToast('JSON exportado!', 'success');
}

async function resetToDefaults() {
    if (!confirm('Restaurar cursos originais? Dados importados serão perdidos.')) return;
    TURNOS = JSON.parse(JSON.stringify(DEFAULT_TURNOS));
    rebuildUI();
    const st = document.getElementById('adminStatus');
    try {
        await publishToGitHub(JSON.stringify(TURNOS, null, 2));
        if (st) st.innerHTML = '<div class="admin-status success">Restaurado e publicado!<br><small>Atualiza para todos em ~30s.</small></div>';
        showToast('Restaurado e publicado!', 'success');
    } catch(e) {
        if (st) st.innerHTML = '<div class="admin-status error">Restaurado localmente, mas não publicou:<br>' + e.message + '</div>';
    }
}

function downloadCSVTemplate() {
    const h = 'turno,turno_badge,name,tag,title,subtitle,instructor,instrRole,desc,publico,duracao,vagas';
    let rows = '';
    TURNOS.forEach(t => {
        t.courses.forEach(c => {
            rows += '\n' + [
                '"' + t.shortLabel + '"', '"' + t.badge + '"',
                '"' + c.name + '"', '"' + (c.tag||'') + '"', '"' + c.title + '"', '"' + (c.subtitle||'') + '"',
                '"' + c.instructor + '"', '"' + (c.instrRole||'') + '"',
                '"' + (c.desc||'').replace(/"/g,'""') + '"', '"' + (c.publico||'').replace(/"/g,'""') + '"',
                c.duracao, c.vagas
            ].join(',');
        });
    });
    const blob = new Blob(['\uFEFF' + h + rows], { type: 'text/csv;charset=utf-8' });
    const a = document.createElement('a'); a.href = URL.createObjectURL(blob);
    a.download = 'modelo-cursos.csv'; a.click(); URL.revokeObjectURL(a.href);
    showToast('Modelo CSV baixado!', 'success');
}

/* ═══════════════════════════════════════════
   UPDATE HERO STATS (after data change)
═══════════════════════════════════════════ */
function updateHeroStats() {
    const totalCourses = TURNOS.reduce((s, t) => s + t.courses.length, 0);
    const totalHours = TURNOS.reduce((s, t) => s + t.courses.reduce((s2, c) => s2 + (parseInt(c.duracao) || 4), 0), 0);
    const stats = document.querySelectorAll('.stat-item .stat-num');
    if (stats.length >= 3) {
        stats[0].textContent = totalCourses;
        stats[1].textContent = TURNOS.length;
        stats[2].textContent = totalHours + 'h';
    }
}
</script>
</body>
</html>
